!function(){var e,t,n,o,i,r,s={},l=[],a=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function c(e,t){for(var n in t)e[n]=t[n];return e}function _(e){var t=e.parentNode;t&&t.removeChild(e)}function u(t,n,o){var i,r,s,l={};for(s in n)"key"==s?i=n[s]:"ref"==s?r=n[s]:l[s]=n[s];if(arguments.length>2&&(l.children=arguments.length>3?e.call(arguments,2):o),"function"==typeof t&&null!=t.defaultProps)for(s in t.defaultProps)void 0===l[s]&&(l[s]=t.defaultProps[s]);return d(t,l,i,r,null)}function d(e,o,i,r,s){var l={type:e,props:o,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==s?++n:s};return null!=t.vnode&&t.vnode(l),l}function f(e){return e.children}function h(e,t){this.props=e,this.context=t}function p(e,t){if(null==t)return e.__?p(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?p(e):null}function g(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return g(e)}}function E(e){(!e.__d&&(e.__d=!0)&&o.push(e)&&!T.__r++||r!==t.debounceRendering)&&((r=t.debounceRendering)||i)(T)}function T(){for(var e;T.__r=o.length;)e=o.sort((function(e,t){return e.__v.__b-t.__v.__b})),o=[],e.some((function(e){var t,n,o,i,r,s;e.__d&&(r=(i=(t=e).__v).__e,(s=t.__P)&&(n=[],(o=c({},i)).__v=i.__v+1,y(s,i,o,t.__n,void 0!==s.ownerSVGElement,null!=i.__h?[r]:null,n,null==r?p(i):r,i.__h),N(n,i),i.__e!=r&&g(i)))}))}function v(e,t,n,o,i,r,a,c,_,u){var h,g,E,T,v,I,b,S=o&&o.__k||l,W=S.length;for(n.__k=[],h=0;h<t.length;h++)if(null!=(T=n.__k[h]=null==(T=t[h])||"boolean"==typeof T?null:"string"==typeof T||"number"==typeof T||"bigint"==typeof T?d(null,T,null,null,T):Array.isArray(T)?d(f,{children:T},null,null,null):T.__b>0?d(T.type,T.props,T.key,null,T.__v):T)){if(T.__=n,T.__b=n.__b+1,null===(E=S[h])||E&&T.key==E.key&&T.type===E.type)S[h]=void 0;else for(g=0;g<W;g++){if((E=S[g])&&T.key==E.key&&T.type===E.type){S[g]=void 0;break}E=null}y(e,T,E=E||s,i,r,a,c,_,u),v=T.__e,(g=T.ref)&&E.ref!=g&&(b||(b=[]),E.ref&&b.push(E.ref,null,T),b.push(g,T.__c||v,T)),null!=v?(null==I&&(I=v),"function"==typeof T.type&&null!=T.__k&&T.__k===E.__k?T.__d=_=C(T,_,e):_=m(e,T,E,S,v,_),u||"option"!==n.type?"function"==typeof n.type&&(n.__d=_):e.value=""):_&&E.__e==_&&_.parentNode!=e&&(_=p(E))}for(n.__e=I,h=W;h--;)null!=S[h]&&("function"==typeof n.type&&null!=S[h].__e&&S[h].__e==n.__d&&(n.__d=p(o,h+1)),P(S[h],S[h]));if(b)for(h=0;h<b.length;h++)A(b[h],b[++h],b[++h])}function C(e,t,n){var o,i;for(o=0;o<e.__k.length;o++)(i=e.__k[o])&&(i.__=e,t="function"==typeof i.type?C(i,t,n):m(n,i,i,e.__k,i.__e,t));return t}function m(e,t,n,o,i,r){var s,l,a;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==n||i!=r||null==i.parentNode)e:if(null==r||r.parentNode!==e)e.appendChild(i),s=null;else{for(l=r,a=0;(l=l.nextSibling)&&a<o.length;a+=2)if(l==i)break e;e.insertBefore(i,r),s=r}return void 0!==s?s:i.nextSibling}function I(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||a.test(t)?n:n+"px"}function b(e,t,n,o,i){var r;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof o&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||I(e.style,t,"");if(n)for(t in n)o&&n[t]===o[t]||I(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])r=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?o||e.addEventListener(t,r?W:S,r):e.removeEventListener(t,r?W:S,r);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null!=n&&(!1!==n||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,n):e.removeAttribute(t))}}function S(e){this.l[e.type+!1](t.event?t.event(e):e)}function W(e){this.l[e.type+!0](t.event?t.event(e):e)}function y(n,o,i,r,l,a,u,d,g){var E,T,C,m,I,S,W,y,N,A,P,R=o.type;if(void 0!==o.constructor)return null;null!=i.__h&&(g=i.__h,d=o.__e=i.__e,o.__h=null,a=[d]),(E=t.__b)&&E(o);try{e:if("function"==typeof R){if(y=o.props,N=(E=R.contextType)&&r[E.__c],A=E?N?N.props.value:E.__:r,i.__c?W=(T=o.__c=i.__c).__=T.__E:("prototype"in R&&R.prototype.render?o.__c=T=new R(y,A):(o.__c=T=new h(y,A),T.constructor=R,T.render=O),N&&N.sub(T),T.props=y,T.state||(T.state={}),T.context=A,T.__n=r,C=T.__d=!0,T.__h=[]),null==T.__s&&(T.__s=T.state),null!=R.getDerivedStateFromProps&&(T.__s==T.state&&(T.__s=c({},T.__s)),c(T.__s,R.getDerivedStateFromProps(y,T.__s))),m=T.props,I=T.state,C)null==R.getDerivedStateFromProps&&null!=T.componentWillMount&&T.componentWillMount(),null!=T.componentDidMount&&T.__h.push(T.componentDidMount);else{if(null==R.getDerivedStateFromProps&&y!==m&&null!=T.componentWillReceiveProps&&T.componentWillReceiveProps(y,A),!T.__e&&null!=T.shouldComponentUpdate&&!1===T.shouldComponentUpdate(y,T.__s,A)||o.__v===i.__v){T.props=y,T.state=T.__s,o.__v!==i.__v&&(T.__d=!1),T.__v=o,o.__e=i.__e,o.__k=i.__k,o.__k.forEach((function(e){e&&(e.__=o)})),T.__h.length&&u.push(T);break e}null!=T.componentWillUpdate&&T.componentWillUpdate(y,T.__s,A),null!=T.componentDidUpdate&&T.__h.push((function(){T.componentDidUpdate(m,I,S)}))}T.context=A,T.props=y,T.state=T.__s,(E=t.__r)&&E(o),T.__d=!1,T.__v=o,T.__P=n,E=T.render(T.props,T.state,T.context),T.state=T.__s,null!=T.getChildContext&&(r=c(c({},r),T.getChildContext())),C||null==T.getSnapshotBeforeUpdate||(S=T.getSnapshotBeforeUpdate(m,I)),P=null!=E&&E.type===f&&null==E.key?E.props.children:E,v(n,Array.isArray(P)?P:[P],o,i,r,l,a,u,d,g),T.base=o.__e,o.__h=null,T.__h.length&&u.push(T),W&&(T.__E=T.__=null),T.__e=!1}else null==a&&o.__v===i.__v?(o.__k=i.__k,o.__e=i.__e):o.__e=function(t,n,o,i,r,l,a,c){var u,d,f,h=o.props,g=n.props,E=n.type,T=0;if("svg"===E&&(r=!0),null!=l)for(;T<l.length;T++)if((u=l[T])&&(u===t||(E?u.localName==E:3==u.nodeType))){t=u,l[T]=null;break}if(null==t){if(null===E)return document.createTextNode(g);t=r?document.createElementNS("http://www.w3.org/2000/svg",E):document.createElement(E,g.is&&g),l=null,c=!1}if(null===E)h===g||c&&t.data===g||(t.data=g);else{if(l=l&&e.call(t.childNodes),d=(h=o.props||s).dangerouslySetInnerHTML,f=g.dangerouslySetInnerHTML,!c){if(null!=l)for(h={},T=0;T<t.attributes.length;T++)h[t.attributes[T].name]=t.attributes[T].value;(f||d)&&(f&&(d&&f.__html==d.__html||f.__html===t.innerHTML)||(t.innerHTML=f&&f.__html||""))}if(function(e,t,n,o,i){var r;for(r in n)"children"===r||"key"===r||r in t||b(e,r,null,n[r],o);for(r in t)i&&"function"!=typeof t[r]||"children"===r||"key"===r||"value"===r||"checked"===r||n[r]===t[r]||b(e,r,t[r],n[r],o)}(t,g,h,r,c),f)n.__k=[];else if(T=n.props.children,v(t,Array.isArray(T)?T:[T],n,o,i,r&&"foreignObject"!==E,l,a,l?l[0]:o.__k&&p(o,0),c),null!=l)for(T=l.length;T--;)null!=l[T]&&_(l[T]);c||("value"in g&&void 0!==(T=g.value)&&(T!==t.value||"progress"===E&&!T)&&b(t,"value",T,h.value,!1),"checked"in g&&void 0!==(T=g.checked)&&T!==t.checked&&b(t,"checked",T,h.checked,!1))}return t}(i.__e,o,i,r,l,a,u,g);(E=t.diffed)&&E(o)}catch(n){o.__v=null,(g||null!=a)&&(o.__e=d,o.__h=!!g,a[a.indexOf(d)]=null),t.__e(n,o,i)}}function N(e,n){t.__c&&t.__c(n,e),e.some((function(n){try{e=n.__h,n.__h=[],e.some((function(e){e.call(n)}))}catch(e){t.__e(e,n.__v)}}))}function A(e,n,o){try{"function"==typeof e?e(n):e.current=n}catch(e){t.__e(e,o)}}function P(e,n,o){var i,r;if(t.unmount&&t.unmount(e),(i=e.ref)&&(i.current&&i.current!==e.__e||A(i,null,n)),null!=(i=e.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){t.__e(e,n)}i.base=i.__P=null}if(i=e.__k)for(r=0;r<i.length;r++)i[r]&&P(i[r],n,"function"!=typeof e.type);o||null==e.__e||_(e.__e),e.__e=e.__d=void 0}function O(e,t,n){return this.constructor(e,n)}function R(n,o,i){var r,l,a;t.__&&t.__(n,o),l=(r="function"==typeof i)?null:i&&i.__k||o.__k,a=[],y(o,n=(!r&&i||o).__k=u(f,null,[n]),l||s,s,void 0!==o.ownerSVGElement,!r&&i?[i]:l?null:o.firstChild?e.call(o.childNodes):null,a,!r&&i?i:l?l.__e:o.firstChild,r),N(a,n)}let w;var D;let M;var G;e=l.slice,t={__e:function(e,t){for(var n,o,i;t=t.__;)if((n=t.__c)&&!n.__)try{if((o=n.constructor)&&null!=o.getDerivedStateFromError&&(n.setState(o.getDerivedStateFromError(e)),i=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e),i=n.__d),i)return n.__E=n}catch(t){e=t}throw e}},n=0,h.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=c({},this.state),"function"==typeof e&&(e=e(c({},n),this.props)),e&&c(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),E(this))},h.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),E(this))},h.prototype.render=f,o=[],i="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,T.__r=0,(D=w||(w={})).INFO="info",D.ALERT="alert",D.DANGER="danger",D.BASIC="basic",D.BASIC_BORDERLESS="basic-borderless",(G=M||(M={})).ALERT="alert",G.INFO="info";var B,U,k,x=0,L=[],V=t.__b,K=t.__r,H=t.diffed,Q=t.__c,Y=t.unmount;function F(e,n){t.__h&&t.__h(U,e,x||n),x=0;var o=U.__H||(U.__H={__:[],__h:[]});return e>=o.__.length&&o.__.push({}),o.__[e]}function $(e){return x=1,function(e,t,n){var o=F(B++,2);return o.t=e,o.__c||(o.__=[n?n(t):Z(void 0,t),function(e){var t=o.t(o.__[0],e);o.__[0]!==t&&(o.__=[t,o.__[1]],o.__c.setState({}))}],o.__c=U),o.__}(Z,e)}function z(e,n){var o,i,r=F(B++,3);!t.__s&&(o=r.__H,i=n,!o||o.length!==i.length||i.some((function(e,t){return e!==o[t]})))&&(r.__=e,r.__H=n,U.__H.__h.push(r))}function J(){L.forEach((function(e){if(e.__P)try{e.__H.__h.forEach(q),e.__H.__h.forEach(X),e.__H.__h=[]}catch(n){e.__H.__h=[],t.__e(n,e.__v)}})),L=[]}t.__b=function(e){U=null,V&&V(e)},t.__r=function(e){K&&K(e),B=0;var t=(U=e.__c).__H;t&&(t.__h.forEach(q),t.__h.forEach(X),t.__h=[])},t.diffed=function(e){H&&H(e);var n=e.__c;n&&n.__H&&n.__H.__h.length&&(1!==L.push(n)&&k===t.requestAnimationFrame||((k=t.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(o),j&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,100);j&&(t=requestAnimationFrame(n))})(J)),U=void 0},t.__c=function(e,n){n.some((function(e){try{e.__h.forEach(q),e.__h=e.__h.filter((function(e){return!e.__||X(e)}))}catch(o){n.some((function(e){e.__h&&(e.__h=[])})),n=[],t.__e(o,e.__v)}})),Q&&Q(e,n)},t.unmount=function(e){Y&&Y(e);var n=e.__c;if(n&&n.__H)try{n.__H.__.forEach(q)}catch(e){t.__e(e,n.__v)}};var j="function"==typeof requestAnimationFrame;function q(e){var t=U;"function"==typeof e.__c&&e.__c(),U=t}function X(e){var t=U;e.__c=e.__(),U=t}function Z(e,t){return"function"==typeof t?t(e):t}const ee=({closable:e=!1,autoClose:t=!1,type:n=w.INFO,icon:o,margin:i,text:r,autoCloseDuration:s=5,...l})=>{const[a,c]=$(!1),[_,d]=$(null);return z(()=>{t&&!_&&d(setTimeout(()=>{c(!0)},1e3*s))},[t,s]),u(f,null,!a&&u("div",{class:`lum-AlertWarning${o&&o.length?" icon":""}${i&&i.length?" margin-"+i:""}${t?" autoClose":""}`},u("div",{id:"message",class:n},t&&u("div",{class:"timeout-indicator",style:{animationDuration:s+"s"}}),o&&o.length&&u("span",{class:"icon "+o},u("span",null)),u("span",{class:"text"},r),e&&u("button",{class:"close",onClick:()=>{c(!0)}},"x"))))};function te(e){return"0"===e?0:"string"==typeof e?parseFloat(e):void 0}function ne(e){return!!e&&e.search(/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/g)>-1}function oe(e){if(!e||!ne(e))return null;const t=e.split(".");return{a:parseInt(t[0]),b:parseInt(t[1]),c:parseInt(t[2]),d:parseInt(t[3])}}function ie(e,t,n,o){return void 0!==e&&void 0!==t&&void 0!==n&&void 0!==o?`${e}.${t}.${n}.${o}`:null}class re{_messages=[];constructor(e){this.reRender=e,this.renderActionSection=this.renderActionSection.bind(this),this.newDialog=this.newDialog.bind(this)}get dialogConfig(){return this._dialogConfig}set dialogConfig(e){this._dialogConfig=e,this.reRender()}get messages(){return this._messages}set messages(e){this._messages=e,this.reRender()}renderActionSection(){return u(f,null,this.messages&&!!this.messages.length&&u("div",{class:"lum-messages"+(this.dialogConfig?" mb-small":"")},this.messages.map(e=>e)),this.dialogConfig&&u("section",{class:"action-section no-margin"},this.dialogConfig.warningText&&u("div",null,u(ee,{icon:this.dialogConfig.warningIcon,type:w.BASIC_BORDERLESS,text:this.dialogConfig.warningText})),u("div",null,u("button",{onClick:()=>{this.dialogConfig&&"function"==typeof this.dialogConfig.onCancel?this.dialogConfig.onCancel():this.dialogConfig=null}},this.dialogConfig.cancelText),u("button",{class:this.dialogConfig.okClass||"primary",onClick:()=>{this.dialogConfig&&"function"==typeof this.dialogConfig.onOk?this.dialogConfig.onOk():this.dialogConfig=null}},this.dialogConfig.okText))))}newDialog(e){this.dialogConfig&&this.dialogConfig.id===e.id||(this.dialogConfig={cancelText:"Cancel",okText:"Ok",...e},this.reRender())}clear(){this.dialogConfig=null,this.messages=[],this.reRender()}addMessage(e){this.messages=[...this.messages,u("div",{key:"_"+Math.random().toString(36).substr(2,9)},e)]}}let se;var le;(le=se||(se={}))[le.DEVICE_NAME=1]="DEVICE_NAME",le[le.DEVICE_TYPE=2]="DEVICE_TYPE",le[le.NETWORK_IP1=3]="NETWORK_IP1",le[le.NETWORK_IP2=4]="NETWORK_IP2",le[le.NETWORK_IP3=5]="NETWORK_IP3",le[le.NETWORK_IP4=6]="NETWORK_IP4",le[le.NETWORK_GATEWAY1=7]="NETWORK_GATEWAY1",le[le.NETWORK_GATEWAY2=8]="NETWORK_GATEWAY2",le[le.NETWORK_GATEWAY3=9]="NETWORK_GATEWAY3",le[le.NETWORK_GATEWAY4=10]="NETWORK_GATEWAY4",le[le.NETWORK_SUBNET1=11]="NETWORK_SUBNET1",le[le.NETWORK_SUBNET2=12]="NETWORK_SUBNET2",le[le.NETWORK_SUBNET3=13]="NETWORK_SUBNET3",le[le.NETWORK_SUBNET4=14]="NETWORK_SUBNET4",le[le.NETWORK_SSID=15]="NETWORK_SSID",le[le.NETWORK_PASS=16]="NETWORK_PASS",le[le.NETWORK_DHCP=17]="NETWORK_DHCP",le[le.ACCESS_POINT_PASS=18]="ACCESS_POINT_PASS",le[le.GPIO_W=19]="GPIO_W",le[le.GPIO_WW=20]="GPIO_WW",le[le.GPIO_R=21]="GPIO_R",le[le.GPIO_G=22]="GPIO_G",le[le.GPIO_B=23]="GPIO_B",le[le.MQTT_ENABLED=24]="MQTT_ENABLED",le[le.MQTT_CLIENT_ID=25]="MQTT_CLIENT_ID",le[le.MQTT_USER=26]="MQTT_USER",le[le.MQTT_PASSWORD=27]="MQTT_PASSWORD",le[le.MQTT_IP1=28]="MQTT_IP1",le[le.MQTT_IP2=29]="MQTT_IP2",le[le.MQTT_IP3=30]="MQTT_IP3",le[le.MQTT_IP4=31]="MQTT_IP4",le[le.MQTT_PORT=32]="MQTT_PORT",le[le.MQTT_DEVICE_TOPIC=33]="MQTT_DEVICE_TOPIC",le[le.MQTT_AUTO_DISCOVERY=34]="MQTT_AUTO_DISCOVERY",le[le.E131_ENABLED=35]="E131_ENABLED",le[le.E131_UNIVERSE=36]="E131_UNIVERSE",le[le.E131_START_CHAN=37]="E131_START_CHAN",le[le.E131_MANUAL=38]="E131_MANUAL",le[le.E131_G_CHAN=39]="E131_G_CHAN",le[le.E131_B_CHAN=40]="E131_B_CHAN",le[le.E131_W_CHAN=41]="E131_W_CHAN",le[le.E131_WW_CHAN=42]="E131_WW_CHAN",le[le.INITIAL_W=43]="INITIAL_W",le[le.INITIAL_WW=44]="INITIAL_WW",le[le.INITIAL_R=45]="INITIAL_R",le[le.INITIAL_G=46]="INITIAL_G",le[le.INITIAL_B=47]="INITIAL_B";const ae=({variant:e="primary",margin:t=!1,...n})=>u("div",{class:`lum-Chip ${e}${t?" margin-small":""}`},n.text||n.children);class ce{DEVELOPMENT=!1;HOST=document.location.host;constructor(){}jsonGET(e){return fetch(e).then((function(e){return e.json()}))}jsonPOST(e,t){return fetch(e,{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:t&&JSON.stringify(t)||""}).then(e=>e.json())}emptyPOST(e){return fetch(e,{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"text/plain"}}).then(e=>e.json())}}let _e;var ue;(ue=_e||(_e={}))[ue.NONE=0]="NONE",ue[ue.RGBWW=1]="RGBWW",ue[ue.RGBW=2]="RGBW",ue[ue.RGB=3]="RGB",ue[ue.WW=4]="WW",ue[ue.W=5]="W";class de extends ce{constructor(){super()}getDto(e){return[null,e[se.DEVICE_NAME],e[se.DEVICE_TYPE],e[se.NETWORK_IP1],e[se.NETWORK_IP2],e[se.NETWORK_IP3],e[se.NETWORK_IP4],e[se.NETWORK_GATEWAY1],e[se.NETWORK_GATEWAY2],e[se.NETWORK_GATEWAY3],e[se.NETWORK_GATEWAY4],e[se.NETWORK_SUBNET1],e[se.NETWORK_SUBNET2],e[se.NETWORK_SUBNET3],e[se.NETWORK_SUBNET4],e[se.NETWORK_SSID],e[se.NETWORK_PASS],e[se.NETWORK_DHCP],e[se.ACCESS_POINT_PASS],e[se.GPIO_W],e[se.GPIO_WW],e[se.GPIO_R],e[se.GPIO_G],e[se.GPIO_B],e[se.MQTT_ENABLED],e[se.MQTT_CLIENT_ID],e[se.MQTT_USER],e[se.MQTT_PASSWORD],e[se.MQTT_IP1],e[se.MQTT_IP2],e[se.MQTT_IP3],e[se.MQTT_IP4],e[se.MQTT_PORT],e[se.MQTT_DEVICE_TOPIC],e[se.MQTT_AUTO_DISCOVERY],e[se.E131_ENABLED],e[se.E131_UNIVERSE],e[se.E131_START_CHAN],e[se.E131_MANUAL],e[se.E131_G_CHAN],e[se.E131_B_CHAN],e[se.E131_W_CHAN],e[se.E131_WW_CHAN],e[se.INITIAL_W],e[se.INITIAL_WW],e[se.INITIAL_R],e[se.INITIAL_G],e[se.INITIAL_B]]}getJsonFromDto(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}loadConfigJson=()=>new Promise((e,t)=>{this.DEVELOPMENT?e({[se.DEVICE_NAME]:"My Smart Bulb",[se.DEVICE_TYPE]:_e.RGBWW,[se.GPIO_R]:12,[se.GPIO_G]:14,[se.GPIO_B]:16,[se.GPIO_W]:15,[se.GPIO_WW]:13,[se.NETWORK_SSID]:"My_SSID",[se.NETWORK_DHCP]:!1,[se.NETWORK_IP1]:192,[se.NETWORK_IP2]:168,[se.NETWORK_IP3]:1,[se.NETWORK_IP4]:193,[se.NETWORK_GATEWAY1]:192,[se.NETWORK_GATEWAY2]:168,[se.NETWORK_GATEWAY3]:1,[se.NETWORK_GATEWAY4]:1,[se.NETWORK_SUBNET1]:255,[se.NETWORK_SUBNET2]:255,[se.NETWORK_SUBNET3]:0,[se.NETWORK_SUBNET4]:0}):this.jsonGET("config").then(t=>{const n=this.getJsonFromDto(t);e(n)}).catch((function(e){t(e)}))});saveConfigJson=e=>new Promise((t,n)=>{if(this.DEVELOPMENT)return void t(!0);const o=this.getDto(e);this.jsonPOST("config",o).then((function(e){!0===e.success&&t(!0)})).catch((function(e){n(e)}))});hasUnsavedChanges(e,t){return(e?JSON.stringify(e):"")!==(t?JSON.stringify(t):"")}}let fe;var he;(he=fe||(fe={}))[he.STANDBY=0]="STANDBY",he[he.RGB=1]="RGB",he[he.WHITE=2]="WHITE",he[he.WARM_WHITE=3]="WARM_WHITE",he[he.TEMP=4]="TEMP",he[he.GPIO_R=5]="GPIO_R",he[he.GPIO_G=6]="GPIO_G",he[he.GPIO_B=7]="GPIO_B",he[he.GPIO_W=8]="GPIO_W",he[he.GPIO_WW=9]="GPIO_WW";var pe={};!function(e){if("object"==typeof pe)pe=e();else{var t;try{t=window}catch(e){t=self}t.SparkMD5=e()}}((function(e){var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(e,t){var n=e[0],o=e[1],i=e[2],r=e[3];o=((o+=((i=((i+=((r=((r+=((n=((n+=(o&i|~o&r)+t[0]-680876936|0)<<7|n>>>25)+o|0)&o|~n&i)+t[1]-389564586|0)<<12|r>>>20)+n|0)&n|~r&o)+t[2]+606105819|0)<<17|i>>>15)+r|0)&r|~i&n)+t[3]-1044525330|0)<<22|o>>>10)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o&i|~o&r)+t[4]-176418897|0)<<7|n>>>25)+o|0)&o|~n&i)+t[5]+1200080426|0)<<12|r>>>20)+n|0)&n|~r&o)+t[6]-1473231341|0)<<17|i>>>15)+r|0)&r|~i&n)+t[7]-45705983|0)<<22|o>>>10)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o&i|~o&r)+t[8]+1770035416|0)<<7|n>>>25)+o|0)&o|~n&i)+t[9]-1958414417|0)<<12|r>>>20)+n|0)&n|~r&o)+t[10]-42063|0)<<17|i>>>15)+r|0)&r|~i&n)+t[11]-1990404162|0)<<22|o>>>10)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o&i|~o&r)+t[12]+1804603682|0)<<7|n>>>25)+o|0)&o|~n&i)+t[13]-40341101|0)<<12|r>>>20)+n|0)&n|~r&o)+t[14]-1502002290|0)<<17|i>>>15)+r|0)&r|~i&n)+t[15]+1236535329|0)<<22|o>>>10)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o&r|i&~r)+t[1]-165796510|0)<<5|n>>>27)+o|0)&i|o&~i)+t[6]-1069501632|0)<<9|r>>>23)+n|0)&o|n&~o)+t[11]+643717713|0)<<14|i>>>18)+r|0)&n|r&~n)+t[0]-373897302|0)<<20|o>>>12)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o&r|i&~r)+t[5]-701558691|0)<<5|n>>>27)+o|0)&i|o&~i)+t[10]+38016083|0)<<9|r>>>23)+n|0)&o|n&~o)+t[15]-660478335|0)<<14|i>>>18)+r|0)&n|r&~n)+t[4]-405537848|0)<<20|o>>>12)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o&r|i&~r)+t[9]+568446438|0)<<5|n>>>27)+o|0)&i|o&~i)+t[14]-1019803690|0)<<9|r>>>23)+n|0)&o|n&~o)+t[3]-187363961|0)<<14|i>>>18)+r|0)&n|r&~n)+t[8]+1163531501|0)<<20|o>>>12)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o&r|i&~r)+t[13]-1444681467|0)<<5|n>>>27)+o|0)&i|o&~i)+t[2]-51403784|0)<<9|r>>>23)+n|0)&o|n&~o)+t[7]+1735328473|0)<<14|i>>>18)+r|0)&n|r&~n)+t[12]-1926607734|0)<<20|o>>>12)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o^i^r)+t[5]-378558|0)<<4|n>>>28)+o|0)^o^i)+t[8]-2022574463|0)<<11|r>>>21)+n|0)^n^o)+t[11]+1839030562|0)<<16|i>>>16)+r|0)^r^n)+t[14]-35309556|0)<<23|o>>>9)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o^i^r)+t[1]-1530992060|0)<<4|n>>>28)+o|0)^o^i)+t[4]+1272893353|0)<<11|r>>>21)+n|0)^n^o)+t[7]-155497632|0)<<16|i>>>16)+r|0)^r^n)+t[10]-1094730640|0)<<23|o>>>9)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o^i^r)+t[13]+681279174|0)<<4|n>>>28)+o|0)^o^i)+t[0]-358537222|0)<<11|r>>>21)+n|0)^n^o)+t[3]-722521979|0)<<16|i>>>16)+r|0)^r^n)+t[6]+76029189|0)<<23|o>>>9)+i|0,o=((o+=((i=((i+=((r=((r+=((n=((n+=(o^i^r)+t[9]-640364487|0)<<4|n>>>28)+o|0)^o^i)+t[12]-421815835|0)<<11|r>>>21)+n|0)^n^o)+t[15]+530742520|0)<<16|i>>>16)+r|0)^r^n)+t[2]-995338651|0)<<23|o>>>9)+i|0,o=((o+=((r=((r+=(o^((n=((n+=(i^(o|~r))+t[0]-198630844|0)<<6|n>>>26)+o|0)|~i))+t[7]+1126891415|0)<<10|r>>>22)+n|0)^((i=((i+=(n^(r|~o))+t[14]-1416354905|0)<<15|i>>>17)+r|0)|~n))+t[5]-57434055|0)<<21|o>>>11)+i|0,o=((o+=((r=((r+=(o^((n=((n+=(i^(o|~r))+t[12]+1700485571|0)<<6|n>>>26)+o|0)|~i))+t[3]-1894986606|0)<<10|r>>>22)+n|0)^((i=((i+=(n^(r|~o))+t[10]-1051523|0)<<15|i>>>17)+r|0)|~n))+t[1]-2054922799|0)<<21|o>>>11)+i|0,o=((o+=((r=((r+=(o^((n=((n+=(i^(o|~r))+t[8]+1873313359|0)<<6|n>>>26)+o|0)|~i))+t[15]-30611744|0)<<10|r>>>22)+n|0)^((i=((i+=(n^(r|~o))+t[6]-1560198380|0)<<15|i>>>17)+r|0)|~n))+t[13]+1309151649|0)<<21|o>>>11)+i|0,o=((o+=((r=((r+=(o^((n=((n+=(i^(o|~r))+t[4]-145523070|0)<<6|n>>>26)+o|0)|~i))+t[11]-1120210379|0)<<10|r>>>22)+n|0)^((i=((i+=(n^(r|~o))+t[2]+718787259|0)<<15|i>>>17)+r|0)|~n))+t[9]-343485551|0)<<21|o>>>11)+i|0,e[0]=n+e[0]|0,e[1]=o+e[1]|0,e[2]=i+e[2]|0,e[3]=r+e[3]|0}function o(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function i(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function r(e){var t,i,r,s,l,a,c=e.length,_=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)n(_,o(e.substring(t-64,t)));for(i=(e=e.substring(t-64)).length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(n(_,r),t=0;t<16;t+=1)r[t]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),l=parseInt(s[2],16),a=parseInt(s[1],16)||0,r[14]=l,r[15]=a,n(_,r),_}function s(e){var n,o="";for(n=0;n<4;n+=1)o+=t[e>>8*n+4&15]+t[e>>8*n&15];return o}function l(e){var t;for(t=0;t<e.length;t+=1)e[t]=s(e[t]);return e.join("")}function a(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function c(e){var t,n=[],o=e.length;for(t=0;t<o-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function _(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==l(r("hello"))&&function(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(n,o){var i,r,s,l,a=this.byteLength,c=t(n,a),_=a;return o!==e&&(_=t(o,a)),c>_?new ArrayBuffer(0):(i=_-c,r=new ArrayBuffer(i),s=new Uint8Array(r),l=new Uint8Array(this,c,i),s.set(l),r)}}(),_.prototype.append=function(e){return this.appendBinary(a(e)),this},_.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,i=this._buff.length;for(t=64;t<=i;t+=64)n(this._hash,o(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},_.prototype.end=function(e){var t,n,o=this._buff,i=o.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)r[t>>2]|=o.charCodeAt(t)<<(t%4<<3);return this._finish(r,i),n=l(this._hash),e&&(n=c(n)),this.reset(),n},_.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},_.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},_.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},_.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},_.prototype._finish=function(e,t){var o,i,r,s=t;if(e[s>>2]|=128<<(s%4<<3),s>55)for(n(this._hash,e),s=0;s<16;s+=1)e[s]=0;o=(o=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(o[2],16),r=parseInt(o[1],16)||0,e[14]=i,e[15]=r,n(this._hash,e)},_.hash=function(e,t){return _.hashBinary(a(e),t)},_.hashBinary=function(e,t){var n=l(r(e));return t?c(n):n},_.ArrayBuffer=function(){this.reset()},_.ArrayBuffer.prototype.append=function(e){var t,o,r,s,l,a=(o=this._buff.buffer,r=e,s=!0,(l=new Uint8Array(o.byteLength+r.byteLength)).set(new Uint8Array(o)),l.set(new Uint8Array(r),o.byteLength),s?l:l.buffer),c=a.length;for(this._length+=e.byteLength,t=64;t<=c;t+=64)n(this._hash,i(a.subarray(t-64,t)));return this._buff=t-64<c?new Uint8Array(a.buffer.slice(t-64)):new Uint8Array(0),this},_.ArrayBuffer.prototype.end=function(e){var t,n,o=this._buff,i=o.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)r[t>>2]|=o[t]<<(t%4<<3);return this._finish(r,i),n=l(this._hash),e&&(n=c(n)),this.reset(),n},_.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},_.ArrayBuffer.prototype.getState=function(){var e,t=_.prototype.getState.call(this);return t.buff=(e=t.buff,String.fromCharCode.apply(null,new Uint8Array(e))),t},_.ArrayBuffer.prototype.setState=function(e){return e.buff=function(e,t){var n,o=e.length,i=new ArrayBuffer(o),r=new Uint8Array(i);for(n=0;n<o;n+=1)r[n]=e.charCodeAt(n);return t?r:i}(e.buff,!0),_.prototype.setState.call(this,e)},_.ArrayBuffer.prototype.destroy=_.prototype.destroy,_.ArrayBuffer.prototype._finish=_.prototype._finish,_.ArrayBuffer.hash=function(e,t){var o=l(function(e){var t,o,r,s,l,a,c=e.length,_=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)n(_,i(e.subarray(t-64,t)));for(o=(e=t-64<c?e.subarray(t-64):new Uint8Array(0)).length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<o;t+=1)r[t>>2]|=e[t]<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(n(_,r),t=0;t<16;t+=1)r[t]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),l=parseInt(s[2],16),a=parseInt(s[1],16)||0,r[14]=l,r[15]=a,n(_,r),_}(new Uint8Array(e)));return t?c(o):o},_}));const ge=e=>{const[t,n]=$(e.value);return u("div",{class:"lum-DropdownMenu"},u("select",{value:e.value,class:e.placeholder&&void 0===e.value&&void 0===t?"placeholder":"",onChange:t=>{const o=t.target.value,i="number"===e.type?te(o):o;n(i),"function"==typeof e.onSelect&&e.onSelect(i)}},e.placeholder&&u(f,null,u("option",{value:"",disabled:!0,selected:!0},e.placeholder),u("option",{value:"",disabled:!0},"---------------------------")),e.children),u("div",{class:"dropdown-indicator"}))},Ee=e=>{const t=t=>{const n=t.target.value;return"number"===e.type?te(n):n.slice(0,e.maxLength||500)};return u("div",{class:"lum-Input"+(e.disabled?" disabled":"")},u("input",{disabled:e.disabled,type:e.type,class:"lum-Input-input",value:e.value,onInput:n=>{const o=t(n);"function"==typeof e.onChange&&e.onChange(o)},onBlur:n=>{const o=t(n);"function"==typeof e.onBlur&&e.onBlur(o)},onKeyPress:n=>{"Enter"===n.key&&"function"==typeof e.onEnter&&e.onEnter(t(n))}}),e.children)},Te=({progress:e=0,...t})=>u("div",{class:"lum-Progress"},u("div",{class:"progress-bar",style:{width:e+"%"}})),ve=e=>u("div",{class:"lum-ToggleSwitch "+(void 0!==e.on&&e.on?"ON":"OFF")+(e.disabled?" disabled":""),ontouchstart:"return true;",onClick:()=>{"function"!=typeof e.onClick||e.disabled||e.onClick(!e.on)}},u("div",{class:"circle"})),Ce=({config:e={},bannerService:t,hardwareService:n,websocketService:o,configService:i,...r})=>{const[s,l]=$("setup"),[a,c]=$(!1),[_,d]=$(),[h,p]=$(!1),[g,E]=$(),[T,v]=$(0),C=e=>{"function"==typeof r.onControlModeToggle&&(r.controlMode===e?r.onControlModeToggle(fe.STANDBY):r.onControlModeToggle(e))},m=()=>{d(null),E(null),v(0),l("setup")};return u(f,null,"setup"===s&&u(f,null,u("section",null,u("div",{class:"grid-large"},u("div",{class:"form-group no-margin"},u("label",{for:"name"},"Device Name"),u(Ee,{value:e[se.DEVICE_NAME]||void 0,maxLength:40,onChange:t=>{"function"==typeof r.onConfigUpdate&&r.onConfigUpdate({...e,[se.DEVICE_NAME]:t})}}),u("div",{class:"helper-text"},"Max 40 characters")),u("div",{class:"form-group no-margin"},u("label",{for:"name"},"Device Type"),u(ge,{type:"number",placeholder:"Select a device type",value:e[se.DEVICE_TYPE]||void 0,onSelect:t=>{"function"==typeof r.onConfigUpdate&&r.onConfigUpdate({...e,[se.DEVICE_TYPE]:t})}},u("option",{value:"1"},"RGBWW (RGB w/ Cool / Warm White)"),u("option",{value:"2"},"RGBW (RGB w/ White)"),u("option",{value:"3"},"RGB"),u("option",{value:"4"},"WW (Cool / Warm White)"),u("option",{value:"5"},"W (White w/o Temp Control)"))))),u("section",null,u("div",{class:"grid-large"},u("div",null,u("label",{class:"mb-small"},"GPIO Mapping"),u("table",null,u("tr",{class:"header-row"},u("th",null,"Channel"),u("th",null,"GPIO"),u("th",null,"Test")),(e[se.DEVICE_TYPE]===_e.RGB||e[se.DEVICE_TYPE]===_e.RGBW||e[se.DEVICE_TYPE]===_e.RGBWW)&&u(f,null,u("tr",null,u("td",null,"Red"),u("td",null,u(Ee,{value:e[se.GPIO_R]||void 0,type:"number",onChange:t=>{"function"==typeof r.onConfigUpdate&&r.onConfigUpdate({...e,[se.GPIO_R]:t})}})),u("td",null,u(ve,{on:r.controlMode===fe.GPIO_R,onClick:()=>{C(fe.GPIO_R)}}))),u("tr",null,u("td",null,"Green"),u("td",null,u(Ee,{value:e[se.GPIO_G]||void 0,type:"number",onChange:t=>{"function"==typeof r.onConfigUpdate&&r.onConfigUpdate({...e,[se.GPIO_G]:t})}})),u("td",null,u(ve,{on:r.controlMode===fe.GPIO_G,onClick:()=>{C(fe.GPIO_G)}}))),u("tr",null,u("td",null,"Blue"),u("td",null,u(Ee,{value:e[se.GPIO_B]||void 0,type:"number",onChange:t=>{"function"==typeof r.onConfigUpdate&&r.onConfigUpdate({...e,[se.GPIO_B]:t})}})),u("td",null,u(ve,{on:r.controlMode===fe.GPIO_B,onClick:()=>{C(fe.GPIO_B)}})))),e[se.DEVICE_TYPE]!==_e.RGB&&u("tr",null,u("td",null,"White"),u("td",null,u(Ee,{value:e[se.GPIO_W]||void 0,type:"number",onChange:t=>{"function"==typeof r.onConfigUpdate&&r.onConfigUpdate({...e,[se.GPIO_W]:t})}})),u("td",null,u(ve,{on:r.controlMode===fe.GPIO_W,onClick:()=>{C(fe.GPIO_W)}}))),(e[se.DEVICE_TYPE]===_e.RGBWW||e[se.DEVICE_TYPE]===_e.WW)&&u("tr",null,u("td",null,"Warm White"),u("td",null,u(Ee,{value:e[se.GPIO_WW]||void 0,type:"number",onChange:t=>{"function"==typeof r.onConfigUpdate&&r.onConfigUpdate({...e,[se.GPIO_WW]:t})}})),u("td",null,u(ve,{on:r.controlMode===fe.GPIO_WW,onClick:()=>{C(fe.GPIO_WW)}})))),(r.controlMode===fe.GPIO_WW||r.controlMode===fe.GPIO_W||r.controlMode===fe.GPIO_R||r.controlMode===fe.GPIO_G||r.controlMode===fe.GPIO_B)&&u(ee,{icon:M.INFO,text:"While GPIO testing is enabled, Lumenator will attempt to turn on the GPIO you are testing.  If Lumenator receives commands from other sources such as MQTT, the test will be overidden."})),u("div",null,u("label",{class:"mb-small"},"System"),u("button",{class:"mb-small width-100",onClick:()=>{t&&t.newDialog({warningText:"Are you sure?",okText:"Restart",okClass:"alert",onOk:()=>{"function"==typeof r.onLoading&&r.onLoading(!0),n&&o&&(n.restart(),setTimeout(()=>{o.close(),o.reconnect().then(e=>{e&&(t.clear(),t.addMessage(u(ee,{text:"Restarted successfully",autoClose:!0,closable:!0})),"function"==typeof r.onControlModeToggle&&r.onControlModeToggle(fe.STANDBY),"function"==typeof r.onLoading&&r.onLoading(!1))})},1e3))}})}},"Restart"),u("button",{class:"mb-small width-100",onClick:()=>{t&&t.newDialog({warningText:"Are you sure? This cannot be undone.",okText:"Erase All",okClass:"alert",onOk:()=>{"function"==typeof r.onLoading&&r.onLoading(!0),n&&o&&(n.eraseAll(),setTimeout(()=>{t.clear(),t.addMessage(u(ee,{text:"Erased configuration.  Restarting device...",autoCloseDuration:10,autoClose:!0,closable:!0})),"function"==typeof r.onLoading&&r.onLoading(!1),setTimeout(()=>{t.clear(),t.addMessage(u(ee,{text:"Device has restarted in access point mode.  Connect to the device access point to set up Lumenator.",type:w.DANGER})),n.restart()},1e4)},1e3))}})}},"Erase Configuration"),u("button",{class:"mb-small width-100",onClick:()=>{l("update")}},"Update Firmware"))))),"update"===s&&u(f,null,u("div",{class:"section-action"},u("button",{disabled:a,onClick:m},"Go back")),u("section",null,u("div",{class:"grid-large"},u("div",{class:"form-group no-margin"},u("label",{for:"name",class:"margin-bottom"},"Update Firmware"),u("div",null,u("input",{disabled:a,class:"form-input file-input",type:"file",accept:".bin,.bin.gz",onChange:e=>{if(null!==e&&e.target&&e.target.files){const t=e.target.files[0];t&&d(t)}}})),u("div",{class:"helper-text margin-top"},"Accepted file types are .bin and .bin.gz")),u("div",{class:"form-group no-margin"}),_&&!a&&u("div",{class:"margin-top"},u("button",{class:"primary",onClick:()=>{c(!0);const e=new FormData,t=new XMLHttpRequest;t.addEventListener("load",()=>{200===t.status?p(!0):500!==t.status?E("[HTTP ERROR] "+t.statusText):E(t.responseText),c(!1),v(0)}),t.upload.addEventListener("progress",e=>{v(Math.trunc(e.loaded/e.total*100))}),t.withCredentials=!0,_&&(e=>new Promise((t,n)=>{const o=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,i=Math.ceil(e.size/2097152),r=new pe.ArrayBuffer,s=new FileReader;let l=0;const a=()=>{const t=2097152*l,n=t+2097152>=e.size?e.size:t+2097152;s.readAsArrayBuffer(o.call(e,t,n))};s.onload=e=>{if(e.target){const n=e.target;if(r.append(n.result),l+=1,l<i)a();else{const e=r.end();t(e)}}},s.onerror=e=>{n(e)},a()}))(_).then(n=>{e.append("MD5",n),e.append("firmware",_,"firmware"),t.open("post","/update"),t.send(e)}).catch(()=>{E("Unknown error while upload, check the console for details."),c(!1),v(0)})}},"Upload"),u("button",{class:"ml-small",onClick:m},"Cancel")),a&&void 0!==T&&u("div",null,u(Te,{progress:T||0}))),!a&&g&&u("div",{class:"margin-top"},u(ee,{text:"ERROR: "+g,type:w.ALERT}))),u(ee,{icon:M.ALERT,text:"WARNING: Make sure you upload the correct binary file.  Once the device receives the file, it will attempt to install it.  If firmware other than Lumenator is installed, you may not be able to update over the air again, unless the new firmware supports it.",type:w.DANGER})))},me=({config:e={},...t})=>{const n=(t,n=0,o=!1,i)=>u("tr",{class:"table-row"+(o?" first-row":"")},u("td",null,i&&u(ae,{text:""+e[se.E131_UNIVERSE]})),u("td",null,u(ae,{variant:"basic",text:""+((e[se.E131_START_CHAN]||0)+n-1)})),u("td",null,t));return u(f,null,u("div",{class:"section-action"},u(ve,{onClick:()=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.E131_ENABLED]:!e[se.E131_ENABLED]})},on:e[se.E131_ENABLED]}),u("label",null,"Enable E131 Streaming")),u("section",null,u("div",{class:"grid-large"},u("div",{class:"form-group no-margin"},u("label",{for:"universe"},"Universe"),u(Ee,{id:"universe",type:"number",disabled:!e[se.E131_ENABLED],value:e[se.E131_UNIVERSE]||void 0,maxLength:4,onChange:n=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.E131_UNIVERSE]:n})}}),u("div",{class:"helper-text mt-large"},"The universe to listen for.")),u("div",null),u("div",{class:"form-group"},u("label",{for:"channel"},e[se.E131_MANUAL]?e[se.DEVICE_TYPE]===_e.RGB||e[se.DEVICE_TYPE]===_e.RGBW||e[se.DEVICE_TYPE]===_e.RGBWW?"Red":"Cold White":"Start Channel"),u(Ee,{id:"channel",type:"number",disabled:!e[se.E131_ENABLED],value:e[se.E131_START_CHAN]||void 0,maxLength:4,onChange:n=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.E131_START_CHAN]:n})}}),!e[se.E131_MANUAL]&&u("div",{class:"helper-text mt-large"},"The starting channel assigned to Lumenator.")),u("div",{class:"form-group"},u("label",null,"Manual Mapping"),u(ve,{disabled:!e[se.E131_ENABLED],onClick:()=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.E131_MANUAL]:!e[se.E131_MANUAL]})},on:e[se.E131_MANUAL]})),e[se.E131_MANUAL]&&u(f,null,(e[se.DEVICE_TYPE]===_e.RGB||e[se.DEVICE_TYPE]===_e.RGBW||e[se.DEVICE_TYPE]===_e.RGBWW)&&u(f,null,u("div",{class:"form-group"},u("label",{for:"green"},"Green"),u(Ee,{id:"green",type:"number",disabled:!e[se.E131_ENABLED],value:e[se.E131_G_CHAN]||void 0,maxLength:4,onChange:n=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.E131_G_CHAN]:n})}})),u("div",null),u("div",{class:"form-group"},u("label",{for:"blue"},"Blue"),u(Ee,{id:"blue",type:"number",disabled:!e[se.E131_ENABLED],value:e[se.E131_B_CHAN]||void 0,maxLength:4,onChange:n=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.E131_B_CHAN]:n})}})),u("div",null)),(e[se.DEVICE_TYPE]===_e.RGBWW||e[se.DEVICE_TYPE]===_e.RGBW)&&u(f,null,u("div",{class:"form-group"},u("label",{for:"w"},"Cold White"),u(Ee,{id:"w",type:"number",disabled:!e[se.E131_ENABLED],value:e[se.E131_W_CHAN]||void 0,maxLength:4,onChange:n=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.E131_W_CHAN]:n})}})),u("div",null)),(e[se.DEVICE_TYPE]===_e.RGBWW||e[se.DEVICE_TYPE]===_e.WW)&&u("div",{class:"form-group"},u("label",{for:"WW"},"Warm White"),u(Ee,{id:"WW",type:"number",disabled:!e[se.E131_ENABLED],value:e[se.E131_WW_CHAN]||void 0,maxLength:4,onChange:n=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.E131_WW_CHAN]:n})}}))))),e[se.E131_ENABLED]&&(e[se.E131_UNIVERSE]||0)>0&&(e[se.E131_START_CHAN]||0)>0&&u("section",null,u("div",{class:"form-group no-margin"},u("label",null,"Channel Mapping"),u("table",null,u("tr",{class:"header-row"},u("th",null,"Universe"),u("th",null,"Channel"),u("th",{width:"100%"},"Mapping")),(()=>{let t=[];if(e[se.E131_MANUAL])e[se.DEVICE_TYPE]===_e.RGB||e[se.DEVICE_TYPE]===_e.RGBW||e[se.DEVICE_TYPE]===_e.RGBWW?t=[...t,u("tr",{class:"table-row first-row"},u("td",null,e[se.E131_UNIVERSE]&&u(ae,{text:""+(e[se.E131_UNIVERSE]||"None")})),u("td",null,u(ae,{variant:"basic",text:""+(e[se.E131_START_CHAN]||"None")})),u("td",null,"Red"))]:e[se.DEVICE_TYPE]!==_e.W&&e[se.DEVICE_TYPE]!==_e.WW||(t=[...t,u("tr",{class:"table-row first-row"},u("td",null,e[se.E131_UNIVERSE]&&u(ae,{text:""+(e[se.E131_UNIVERSE]||"None")})),u("td",null,u(ae,{variant:"basic",text:""+(e[se.E131_START_CHAN]||"None")})),u("td",null,"Cold White"))]),e[se.DEVICE_TYPE]!==_e.RGB&&e[se.DEVICE_TYPE]!==_e.RGBW&&e[se.DEVICE_TYPE]!==_e.RGBWW||(t=[...t,u("tr",{class:"table-row"},u("td",null),u("td",null,u(ae,{variant:"basic",text:""+(e[se.E131_G_CHAN]||"None")})),u("td",null,"Green")),u("tr",{class:"table-row"},u("td",null),u("td",null,u(ae,{variant:"basic",text:""+(e[se.E131_B_CHAN]||"None")})),u("td",null,"Blue"))]),e[se.DEVICE_TYPE]!==_e.RGBW&&e[se.DEVICE_TYPE]!==_e.RGBWW||(t=[...t,u("tr",{class:"table-row"},u("td",null),u("td",null,u(ae,{variant:"basic",text:""+(e[se.E131_W_CHAN]||"None")})),u("td",null,"Cold White"))]),e[se.DEVICE_TYPE]!==_e.RGBWW&&e[se.DEVICE_TYPE]!==_e.WW||(t=[...t,u("tr",{class:"table-row"},u("td",null),u("td",null,u(ae,{variant:"basic",text:""+(e[se.E131_WW_CHAN]||"None")})),u("td",null,"Warm White"))]);else{let o=1;e[se.DEVICE_TYPE]!==_e.RGB&&e[se.DEVICE_TYPE]!==_e.RGBW&&e[se.DEVICE_TYPE]!==_e.RGBWW||(t=[...t,n("Red",o,!0,e[se.E131_UNIVERSE]),n("Green",o+1),n("Blue",o+2)],o+=3),e[se.DEVICE_TYPE]!==_e.RGBW&&e[se.DEVICE_TYPE]!==_e.RGBWW&&e[se.DEVICE_TYPE]!==_e.W&&e[se.DEVICE_TYPE]!==_e.WW||(t=[...t,n("Cold White",o,1==o,1==o?e[se.E131_UNIVERSE]:null)],o+=1),e[se.DEVICE_TYPE]!==_e.RGBWW&&e[se.DEVICE_TYPE]!==_e.WW||(t=[...t,n("Warm White",o)])}return t})()))))};class Ie extends ce{url="ws://localhost:8080";constructor(){super(),this.DEVELOPMENT||(this.url="ws://"+this.HOST+":1337"),this.connect()}newWebSocket=()=>(this.websocket=new WebSocket(this.url),this.websocket);close=()=>{this.websocket&&this.websocket.readyState===WebSocket.OPEN&&this.websocket.close()};connect=()=>{console.log("Attempting connection to WS...");const e=this.newWebSocket();return e.onopen=()=>{console.log("WS connection open")},e.onclose=()=>{console.log("WS connection closed")},e.onerror=e=>{console.log("WS Error: ",e)},e};reconnect=()=>new Promise((e,t)=>{if(this.websocket){let t=this.websocket,n=1;const o=setInterval(()=>{switch(t.readyState){case WebSocket.CLOSED:console.log("Starting reconnect..."),t=this.connect();break;case WebSocket.CLOSING:console.log("WS closing...");break;case WebSocket.CONNECTING:console.log("WS connecting...");break;case WebSocket.OPEN:clearInterval(o),e(!0)}n>=30&&clearInterval(o),n+=1},1e3)}else t()});send=e=>{if(this.websocket)switch(this.websocket.readyState){case WebSocket.OPEN:this.DEVELOPMENT?this.websocket.send(JSON.stringify({type:"echo",payload:"test"})):e&&this.websocket.send(e);break;default:this.reconnect()}}}class be extends Ie{constructor(){super()}restart=()=>new Promise((e,t)=>{this.DEVELOPMENT?e(!0):this.emptyPOST("restart").then(()=>{e(!0)}).catch(e=>{t(e)})});eraseAll=()=>{this.send("erase")}}const Se=({variant:e="page",...t})=>u("div",{id:"lum-loader",class:"lum-loader "+e},u("div",{id:"loader",class:"loader"},"Loading...")),We=({config:e={},...t})=>{const[n,o]=$(!1),i=(n,o=!1)=>{if("function"==typeof t.onConfigUpdate)if(ne(n)){const o=oe(n);o&&t.onConfigUpdate({...e,[se.MQTT_IP1]:o.a,[se.MQTT_IP2]:o.b,[se.MQTT_IP3]:o.c,[se.MQTT_IP4]:o.d})}else o&&t.onConfigUpdate({...e})},r=(n,o=!1)=>{var i;"function"==typeof t.onConfigUpdate&&((i=n)&&i.search(/^(?:[a-z0-9\_\-]*\/)*(?:[a-z0-9\_\-]+)+$/g)>-1?t.onConfigUpdate({...e,[se.MQTT_DEVICE_TOPIC]:n}):o&&t.onConfigUpdate({...e}))},s=(n,o=!1)=>{var i;"function"==typeof t.onConfigUpdate&&((i=n)&&i.search(/^(?:[a-z0-9\_\-]*)$/g)>-1?t.onConfigUpdate({...e,[se.MQTT_CLIENT_ID]:n}):o&&t.onConfigUpdate({...e}))};return u(f,null,u("div",{class:"section-action"},u(ve,{onClick:()=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.MQTT_ENABLED]:!e[se.MQTT_ENABLED]})},on:e[se.MQTT_ENABLED]}),u("label",null,"Enable MQTT")),u("section",null,u("div",{class:"grid-large"},u("div",{class:"form-group no-margin"},u("label",{for:"clientId"},"Unique Client ID"),u(Ee,{id:"clientId",disabled:!e[se.MQTT_ENABLED],value:e[se.MQTT_CLIENT_ID]||void 0,maxLength:20,onChange:s,onBlur:e=>{s(e,!0)}}),u("div",{class:"helper-text mt-large"},"Max 20 characters. A unique ID for MQTT broker to identify the device. Alphanumeric characters, underscores, and dashes only. Example: ",u("strong",null,"bedroom_lamp1"))),u("div",{class:"form-group no-margin"},u("label",{for:"topic"},"Home Assistant Auto Discovery"),u(ve,{disabled:!e[se.MQTT_ENABLED],onClick:()=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.MQTT_AUTO_DISCOVERY]:!e[se.MQTT_AUTO_DISCOVERY]})},on:e[se.MQTT_AUTO_DISCOVERY]}),u("div",{class:"helper-text mt-large"},"Will add this device to your entites in Home Assistant automatically.",u("br",null)," See"," ",u("a",{href:"https://www.home-assistant.io/docs/mqtt/discovery/",target:"_blank"},"Home Assistant MQTT Discovery")," ","for details.")),u("div",{class:"form-group"},u("label",{for:"user"},"User"),u(Ee,{id:"user",disabled:!e[se.MQTT_ENABLED],maxLength:40,value:e[se.MQTT_USER]||void 0,onChange:n=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.MQTT_USER]:n})}}),u("div",{class:"helper-text"},"Max 40 characters")),u("div",{class:"form-group"},u("label",{for:"password"},"Password"),u("div",{class:"flex-stretch"},u("div",{class:"flex-grow"},u(Ee,{id:"password",maxLength:20,disabled:!e[se.MQTT_ENABLED],type:n?"string":"password",value:e[se.MQTT_PASSWORD]||void 0,onChange:n=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.MQTT_PASSWORD]:n})}}),u("div",{class:"helper-text"},"Max 20 characters")),u("button",{type:"button",class:"ml-small",onClick:()=>{o(!n)}},n?"Hide":"Show"))),u("div",{class:"form-group"},u("label",{for:"ip"},"MQTT Server IP"),u(Ee,{disabled:!e[se.MQTT_ENABLED],value:ie(e[se.MQTT_IP1],e[se.MQTT_IP2],e[se.MQTT_IP3],e[se.MQTT_IP4])||"",onChange:i,onBlur:e=>{i(e,!0)}})),u("div",{class:"form-group"},u("label",{for:"port"},"Port"),u(Ee,{type:"number",disabled:!e[se.MQTT_ENABLED],value:e[se.MQTT_PORT]||void 0,onChange:n=>{"function"==typeof t.onConfigUpdate&&t.onConfigUpdate({...e,[se.MQTT_PORT]:n})}})))),u("section",null,u("div",{class:"grid-large"},u("div",{class:"form-group no-margin"},u("label",{for:"topic"},"Device Base Topic"),u(Ee,{id:"topic",maxLength:40,disabled:!e[se.MQTT_ENABLED],value:e[se.MQTT_DEVICE_TOPIC]||void 0,onChange:r,onBlur:e=>{r(e,!0)}})),u("div",{class:"form-group"},u("label",{for:"topic"}),u("div",{class:"helper-text mt-large"},"Max 40 characters. The topic that all incoming and outgoing sub topics will be based on for this device. Example:"," ",u("strong",null,"upstairs/bedroom/lamp1"))))),e[se.MQTT_DEVICE_TOPIC]&&u("section",null,u("div",{class:"form-group no-margin"},u("label",null,"MQTT Topics"),u("table",null,u("tr",{class:"header-row"},u("th",null,"Topic"),u("th",null,"Message"),u("th",{width:"100%"},"Description")),u("tr",{class:"first-row"},u("td",null,u(ae,{text:e[se.MQTT_DEVICE_TOPIC]+"/avail"})),u("td",null,u(ae,{variant:"basic",text:"online"})),u("td",null,"The birth message sent to the broker when Lumenator comes online.")),u("tr",null,u("td",null),u("td",null,u(ae,{variant:"basic",text:"offline"})),u("td",null,"The message sent as the last will and testament.")),u("tr",{class:"new-group"},u("td",null,u(ae,{text:e[se.MQTT_DEVICE_TOPIC]+"/state"})),u("td",null,u(ae,{variant:"basic",text:"JSON"})),u("td",null,"This is the topic your broker should subscribe to for state updates. This follows the Home Assistant JSON schema for state.",u("br",null),u("br",null)," See"," ",u("a",{href:"https://www.home-assistant.io/integrations/light.mqtt/#json-schema",target:"_blank"},"MQTT Light - JSON Schema")," ","for more details.")),u("tr",{class:"new-group"},u("td",null,u(ae,{text:e[se.MQTT_DEVICE_TOPIC]+"/set"})),u("td",null,u(ae,{variant:"basic",text:"JSON"})),u("td",null,"This is the topic Lumenator is subscribed to for commands. This follows the Home Assistant JSON schema for sending commands.",u("br",null),u("br",null)," See"," ",u("a",{href:"https://www.home-assistant.io/integrations/light.mqtt/#json-schema",target:"_blank"},"MQTT Light - JSON Schema")," ","for more details."))))))},ye=e=>{const t={current:null},[n,o]=$(e.activeId||0),[i,r]=$(0),s=new ResizeObserver(e=>{for(let t of e)if(t.contentBoxSize){const e=Array.isArray(t.contentBoxSize)?t.contentBoxSize[0]:t.contentBoxSize;e.blockSize!=i&&r(e.blockSize)}else t.contentRect?t.contentRect.height!=i&&r(t.contentRect.height):r(0)});z(()=>{t.current&&s.observe(t.current)},[t]);return u(f,null,u("div",{class:"lum-Nav"+(e.minimized?" minimized":"")},u("ul",{class:"lum-NavMenu"},e.minimized?u("div",null):Array.isArray(e.children)?e.children.map(e=>{const t=e.props;return u("li",{class:"tab"+(e.props.id===n?" active":""),onClick:()=>{o(e.props.id)}},t.title)}):e.children.props?u("li",{class:"tab active"},e.children.props.title):void 0)),i,u("div",{class:"lum-Nav-pushDown"+(e.minimized?" minimized":""),style:{visibility:i?"visible":"hidden"}},u("div",{class:"lum-Nav-pushDown-content",ref:t},"function"==typeof e.renderMessages&&e.renderMessages(),"function"==typeof e.renderActionSection&&e.renderActionSection())),u("main",null,u("div",{class:"pushDown-spacer",style:{height:i,marginBottom:e.minimized?"0":"10px"}}),Array.isArray(e.children)?e.children.find(e=>e.props.id===n):e.children.props?e.children:void 0))},Ne=e=>u("div",null,e.children),Ae=({page:e="app",config:t={},...n})=>{const[o,i]=$(!1),[r,s]=$(!1),l=(e,o=!1,i="IP")=>{if("function"==typeof n.onConfigUpdate)if(ne(e)){const o=oe(e);o&&n.onConfigUpdate({...t,[se[`NETWORK_${i}1`]]:o.a,[se[`NETWORK_${i}2`]]:o.b,[se[`NETWORK_${i}3`]]:o.c,[se[`NETWORK_${i}4`]]:o.d})}else o&&n.onConfigUpdate({...t})};return u(f,null,u("section",null,u("div",{class:"grid-large"},u("div",{class:"form-group no-margin"},u("label",{for:"ssid"},"Network SSID"),u(Ee,{id:"ssid",value:t[se.NETWORK_SSID]||void 0,maxLength:40,onChange:e=>{"function"==typeof n.onConfigUpdate&&n.onConfigUpdate({...t,[se.NETWORK_SSID]:e})}}),u("div",{class:"helper-text"},"Max 40 characters")),u("div",{class:"form-group no-margin"},u("label",{for:"password"},"Network Password"),u("div",{class:"flex-stretch"},u("div",{class:"flex-grow"},u(Ee,{id:"password",type:o||"app"!==e?"string":"password",value:t[se.NETWORK_PASS]||void 0,maxLength:20,onChange:e=>{"function"==typeof n.onConfigUpdate&&n.onConfigUpdate({...t,[se.NETWORK_PASS]:e})}}),u("div",{class:"helper-text"},"Max 20 characters")),"app"===e&&u("button",{type:"button",class:"ml-small",onClick:()=>{i(!o)}},o?"Hide":"Show"))),u("div",{class:"form-group"},u("label",{for:"ip"},"Static IP"),u(Ee,{disabled:t[se.NETWORK_DHCP],value:ie(t[se.NETWORK_IP1],t[se.NETWORK_IP2],t[se.NETWORK_IP3],t[se.NETWORK_IP4])||"",onChange:l,onBlur:e=>{l(e,!0)}}),u("div",{class:"helper-text mt-large"},"Static IPv4 address on the local network.")),u("div",{class:"form-group"},u("label",{for:"ip"},"Use DHCP"),u(ve,{onClick:()=>{"function"==typeof n.onConfigUpdate&&n.onConfigUpdate({...t,[se.NETWORK_DHCP]:!t[se.NETWORK_DHCP]})},on:t[se.NETWORK_DHCP]})),u("div",{class:"form-group"},u("label",{for:"ip"},"Gateway"),u(Ee,{disabled:t[se.NETWORK_DHCP],value:ie(t[se.NETWORK_GATEWAY1],t[se.NETWORK_GATEWAY2],t[se.NETWORK_GATEWAY3],t[se.NETWORK_GATEWAY4])||"",onChange:e=>{l(e,!1,"GATEWAY")},onBlur:e=>{l(e,!0,"GATEWAY")}})),u("div",null),u("div",{class:"form-group"},u("label",{for:"ip"},"Subnet"),u(Ee,{disabled:t[se.NETWORK_DHCP],value:ie(t[se.NETWORK_SUBNET1],t[se.NETWORK_SUBNET2],t[se.NETWORK_SUBNET3],t[se.NETWORK_SUBNET4])||"",onChange:e=>{l(e,!1,"SUBNET")},onBlur:e=>{l(e,!0,"SUBNET")}})))),u("section",null,u("div",{class:"grid-large"},u("div",{class:"form-group no-margin"},u("label",{for:"ssid"},"Access Point Security Password"),u("div",{class:"flex-stretch"},u("div",{class:"flex-grow"},u(Ee,{id:"apPass",maxLength:20,type:r||"app"!==e?"string":"password",value:t[se.ACCESS_POINT_PASS]||void 0,onChange:e=>{"function"==typeof n.onConfigUpdate&&n.onConfigUpdate({...t,[se.ACCESS_POINT_PASS]:e})}}),u("div",{class:"helper-text"},"Max 20 characters")),"app"===e&&u("button",{type:"button",class:"ml-small",onClick:()=>{s(!r)}},r?"Hide":"Show")),u("div",{class:"helper-text mt-large"},"Password for the setup access point"," ","setup"===e?"(this page)":""," when Lumenator cannot connect to the network.")))))};let Pe;var Oe;(Oe=Pe||(Pe={}))[Oe.OFF=0]="OFF",Oe[Oe.ON=1]="ON";class Re extends h{configService=new de;websocketService=new Ie;hardwareService=new be;bannerService=new re(e=>{this.forceUpdate(),e&&this.setState(e)});constructor(){super(),this.state={controlMode:fe.STANDBY,loading:!0},this.saveChangesDialog={id:"saveChanges",warningText:"Unsaved Changes",warningIcon:M.ALERT,okText:"Save Configuration",onOk:()=>{this.saveConfiguration()},onCancel:()=>{this.setState({config:{...this.state.originalConfig}}),this.bannerService.clear()}},this.saveConfiguration=this.saveConfiguration.bind(this)}init=async()=>{try{const e=await this.configService.loadConfigJson();e&&this.setState({originalConfig:{...e},config:{...e},loading:!1})}catch(e){console.error(e),this.setState({loading:!1})}};componentDidMount(){this.init()}componentDidUpdate(){this.bannerService.dialogConfig&&this.bannerService.dialogConfig.id===this.saveChangesDialog.id||!this.configService.hasUnsavedChanges(this.state.originalConfig,this.state.config)||this.bannerService.newDialog(this.saveChangesDialog)}isGpioMode=e=>e===fe.GPIO_B||e===fe.GPIO_G||e===fe.GPIO_R||e===fe.GPIO_W||e===fe.GPIO_WW;handleControlModeToggle=e=>{this.isGpioMode(this.state.controlMode)&&this.websocketService.send(`gpio:${this.state.controlMode}:${Pe.OFF}`),this.isGpioMode(e)&&this.websocketService.send(`gpio:${e}:${Pe.ON}`),e===fe.STANDBY&&this.websocketService.send("standby"),this.setState({controlMode:e})};handleColorSet=e=>{"rgb"===e.type&&this.setState({rgbColor:e.color}),"white"===e.type&&this.setState({whiteColor:e.color}),"whiteValue"===e.type&&this.setState({whiteValueColor:e.color})};saveConfiguration(){this.setState({loading:!0}),this.state.config&&this.configService.saveConfigJson(this.state.config).then(e=>{!0===e&&setTimeout(()=>{this.setState({originalConfig:{...this.state.config},loading:!1}),this.bannerService.clear(),this.bannerService.addMessage(u(ee,{text:"Configuration saved successfully",closable:!0,autoClose:!0}))},1e3)})}render(){return u("div",{id:"lumenator-web-app"},this.state.loading&&u(Se,null),u("header",null,u("div",{class:"header-container"},u("div",{class:"header-items"},u("h2",null,"Lumenator"),this.state.originalConfig&&this.state.originalConfig[se.DEVICE_NAME]&&u(ae,{text:this.state.originalConfig[se.DEVICE_NAME]}),u("div",{class:"version"},"v1.0")))),u(ye,{activeId:1,renderActionSection:()=>this.bannerService.renderActionSection()},u(Ne,{id:1,title:"Device"},u(Ce,{config:this.state.config,bannerService:this.bannerService,hardwareService:this.hardwareService,websocketService:this.websocketService,configService:this.configService,onConfigUpdate:e=>{this.setState({config:{...e}})},onLoading:e=>{this.setState({loading:e})},controlMode:this.state.controlMode,onControlModeToggle:this.handleControlModeToggle})),u(Ne,{id:2,title:"Network"},u(Ae,{config:this.state.config,onConfigUpdate:e=>{this.setState({config:{...e}})}})),u(Ne,{id:3,title:"MQTT"},u(We,{config:this.state.config,onConfigUpdate:e=>{this.setState({config:{...e}})}})),u(Ne,{id:4,title:"E131"},u(me,{config:this.state.config,onConfigUpdate:e=>{this.setState({config:{...e}})}}))))}}class we extends h{hardwareService=new be;configService=new de;constructor(){super(),this.state={accessGranted:!1,errorText:""},this.renderActionSection=this.renderActionSection.bind(this)}init=async()=>{try{const e=await this.configService.loadConfigJson();e&&this.setState({originalConfig:{...e},config:{...e}}),e[se.ACCESS_POINT_PASS]||this.setState({accessGranted:!0})}catch(e){}};componentDidMount(){this.init()}renderActionSection(){return this.configService.hasUnsavedChanges(this.state.originalConfig,this.state.config)?u("section",{class:"action-section no-margin"},u("div",null,u("button",{onClick:()=>{this.setState({config:{...this.state.originalConfig}})}},"Start Over"),u("button",{class:"primary",onClick:()=>{this.state.config&&(this.setState({loading:!0}),this.configService.saveConfigJson(this.state.config).then(e=>{!0===e&&(this.setState({originalConfig:{...this.state.config}}),this.hardwareService.restart())}))}},"Save and Restart"))):u(f,null)}login=()=>{this.state.originalConfig&&(this.state.originalConfig[se.ACCESS_POINT_PASS]==this.state.password?this.setState({accessGranted:!0}):this.setState({errorText:"Invalid password"}))};render(){return u("div",{id:"lumenator-web-app"},this.state.loading&&u(Se,null),u("header",null,u("div",{class:"header-container"},u("div",{class:"header-items"},u("h2",null,"Lumenator")))),u(ye,{minimized:!0,activeId:1,renderActionSection:this.renderActionSection},u(Ne,{id:1,title:"Setup"},!this.state.accessGranted&&u("section",{style:{maxWidth:"400px"}},u("div",{class:"form-group no-margin"},u("label",null,"Setup Password"),u("div",{className:"flex-stretch"},u("div",{class:"flex-grow"},u(Ee,{onEnter:this.login,onChange:e=>{this.setState({password:e})},type:"password"})),u("button",{class:"primary ml-small",onClick:this.login},"Go"))),u("div",{class:"error-text"},this.state.errorText))||u(f,null,u("section",null,u("h4",null,"Welcome!"),u("p",null,'To get started, fill out the network configuration form below, then click "Save and Restart". Once configured, Lumenator will try to connect to your wireless network. If unsuccessful, this access point will become available again for configuration.')),u(Ae,{page:"setup",config:this.state.config,onConfigUpdate:e=>{this.setState({config:{...e}})}})))))}}R(u("setup"===("lumenator-setup"===document.body.id?"setup":"app")?we:Re,null),document.body)}();