!function(){function t(t,i){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var s,r=t[Symbol.iterator]();!(n=(s=r.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==r.return||r.return()}finally{if(o)throw a}}return i}(t,i)||e(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,i){return e&&h(t.prototype,e),i&&h(t,i),t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}function u(t){var e=g();return function(){var i,n=m(t);if(e){var o=m(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return d(this,i)}}function d(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?p(t):e}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t){var e="function"==typeof Map?new Map:void 0;return(v=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return f(t,arguments,m(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),y(n,t)})(t)}function f(t,e,i){return(f=g()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return i&&y(o,i.prototype),o}).apply(null,arguments)}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(e){c(n,e);var i=u(n);function n(t){var e;return r(this,n),(e=i.call(this)).state={},e.attachShadow({mode:"open"}),e.shadowRoot.appendChild(t.content.cloneNode(!0)),e}return l(n,[{key:"isObject",value:function(t){return("object"===s(t)||"function"==typeof t||Array.isArray(t))&&!!t}},{key:"setState",value:function(e){var i=this,n=o({},this.state);Object.entries(e).forEach((function(e){var n=t(e,2),a=n[0],s=n[1];i.state[a]=i.isObject(i.state[a])&&i.isObject(s)?o(o({},i.state[a]),s):s})),"function"==typeof this.onStateChanges&&this.onStateChanges(this.state,n)}},{key:"updateValue",value:function(t){this.state.id&&this.setState(a({},this.state.id,t))}}]),n}(v(HTMLElement)),w=document.createElement("template");w.innerHTML='\n<style>\n\t@import "style.css";\n</style>\n<div class="alert-message">\n\t<div id="message" class="info">\n\t\t<span class="icon hidden"></span>\n\t\t<span class="text"></span>\n\t\t<button class="close">x</button>\n\t</div>\n</div>\n';var x=function(t){c(i,t);var e=u(i);function i(){var t;r(this,i);var n=(t=e.call(this,w)).getAttribute("text");return t.setState({text:n,icon:t.getAttribute("icon"),type:t.getAttribute("type")||"info",closable:!!t.getAttribute("closable"),visible:!!n}),t.onClose=t.onClose.bind(p(t)),t}return l(i,[{key:"onStateChanges",value:function(t,e){if(t.visible||!t.text||t.text===e.text)if(t.visible){var i=t.closable?"closable ".concat(t.type):t.type;if(this.shadowRoot.querySelector("#message").className=i,this.shadowRoot.querySelector("#message span.text").innerHTML=t.text,this.shadowRoot.querySelector(".alert-message").className="alert-message",t.icon){switch(t.icon){case"info":default:this.shadowRoot.querySelector("#message span.icon").innerHTML="i"}this.shadowRoot.querySelector("#message span.icon").className="icon"}else this.shadowRoot.querySelector("#message span.icon").className="icon hidden"}else this.shadowRoot.querySelector(".alert-message").className="alert-message hidden";else this.setState({visible:!0})}},{key:"onClose",value:function(){this.setState({visible:!1,text:null})}},{key:"connectedCallback",value:function(){this.shadowRoot.querySelector("button").addEventListener("click",this.onClose)}},{key:"disconnectedCallback",value:function(){this.shadowRoot.querySelector("button").removeEventListener("click",this.onClose)}}]),i}(b);window.customElements.define("alert-message",x);var S=document.createElement("template");S.innerHTML="\n<style>\n\t@import \"style.css\";\n</style>\n<ul class='nav-menu-ul'><slot></slot></ul>\n";var C=function(t){c(n,t);var i=u(n);function n(){var t;return r(this,n),(t=i.call(this,S)).activeTab=t.getAttribute("activeTab"),t}return l(n,[{key:"resetAllTabs",value:function(t){var i,n=function(t,i){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=e(t))||i&&t&&"number"==typeof t.length){n&&(t=n);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,h=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){h=!0,s=t},f:function(){try{r||null==n.return||n.return()}finally{if(h)throw s}}}}(t);try{for(n.s();!(i=n.n()).done;){var o=i.value;o.shadowRoot.querySelector(".tab").className="tab hidden";var a=o.getAttribute("id"),s=document.getElementById("panel-".concat(a));s&&(s.classList.add("hidden"),s.classList.remove("active"))}}catch(t){n.e(t)}finally{n.f()}}},{key:"onClick",value:function(t){var e=t&&t.target&&t.target.id;if(e){var i=Array.from(this.querySelectorAll("nav-menu-li"));this.resetAllTabs(i),i.find((function(t){return t.getAttribute("id")===e})).shadowRoot.querySelector(".tab").className="tab active";var n=document.getElementById("panel-".concat(e));n&&(n.classList.remove("hidden"),n.classList.add("active"))}}},{key:"connectedCallback",value:function(){this.addEventListener("click",this.onClick)}},{key:"disconnectedCallback",value:function(){this.removeEventListener("click",this.onClick)}}]),n}(b);window.customElements.define("nav-menu",C);var k=document.createElement("template");k.innerHTML='\n<style>\n\t@import "style.css";\n</style>\n<li class="tab hidden"><slot></slot>\n</li>\n';var D=function(t){c(i,t);var e=u(i);function i(){var t;return r(this,i),null!==(t=e.call(this,k)).getAttribute("active")&&(t.shadowRoot.querySelector(".tab").className="tab active"),t}return i}(b);window.customElements.define("nav-menu-li",D);var _=document.createElement("template");_.innerHTML='\n<style>\n\t@import "style.css";\n</style>\n<div class="input-container">\n\t<input id="input" class="text-input">\n\t<slot></slot>\n</div>\n';var z=function(t){c(i,t);var e=u(i);function i(){var t;return r(this,i),(t=e.call(this,_)).setState({id:t.getAttribute("id"),name:t.getAttribute("name"),type:t.getAttribute("type")||"text",value:t.getAttribute("value")||null}),t.onChange=t.onChange.bind(p(t)),t}return l(i,[{key:"onChange",value:function(t){var e=t.target.value,i="number"===this.state.type?parseInt(e,10):e;this.setState({value:i})}},{key:"onStateChanges",value:function(t){var e=this.shadowRoot.querySelector("#input");t.value!==e.value&&(e.value=t.value),this.shadowRoot.querySelector("#input").type=t.type}},{key:"connectedCallback",value:function(){this.shadowRoot.querySelector("#input").addEventListener("change",this.onChange)}},{key:"disconnectedCallback",value:function(){this.shadowRoot.querySelector("#input").removeEventListener("change",this.onChange)}}]),i}(b);window.customElements.define("text-input",z);var E=document.createElement("template");E.innerHTML='\n<style>\n\t@import "style.css";\n</style>\n<div class="dropdown-menu">\n<select id="select" class="placeholder"></select>\n<slot></slot>\n<div class="dropdown-indicator">\n\t<svg xmlns="http://www.w3.org/2000/svg" viewBox=\'0 0 1000 1000\' xmlns:xlink="http://www.w3.org/1999/xlink">\n\t\t<metadata>IcoFont Icons</metadata>\n\t\t<title>simple-down</title>\n\t\t<glyph glyph-name="simple-down" unicode="&#xeab2;" horiz-adv-x="1000" />\n\t\t<path\n\t\t\td="M200 392.6l300 300 300-300-85.10000000000002-85.10000000000002-214.89999999999998 214.79999999999995-214.89999999999998-214.89999999999998-85.10000000000002 85.20000000000005z" />\n\t</svg>\n</div>\n</div>\n';var M=function(t){c(i,t);var e=u(i);function i(){var t;return r(this,i),(t=e.call(this,E)).setState({id:t.getAttribute("id"),name:t.getAttribute("name"),value:t.getAttribute("value")||null}),t.onChange=t.onChange.bind(p(t)),t}return l(i,[{key:"onChange",value:function(t){var e=t.target.value;this.setState({value:e})}},{key:"onStateChanges",value:function(t){var e=this.shadowRoot.querySelector("#select");t.value!==e.value&&(e.value=t.value),e.classList=t.value?"":"placeholder"}},{key:"connectedCallback",value:function(){var t=this;this.shadowRoot.querySelector("#select").addEventListener("change",this.onChange),this.shadowRoot.addEventListener("slotchange",(function(){var e=t.shadowRoot.querySelector("#select"),i=t.querySelector("option");i&&e.append(i)}))}},{key:"disconnectedCallback",value:function(){this.shadowRoot.querySelector("#select").removeEventListener("change",this.onChange),this.shadowRoot.removeEventListener("slotchange")}}]),i}(b);window.customElements.define("dropdown-menu",M);var P=document.createElement("template");P.innerHTML='\n<style>\n\t@import "style.css";\n</style>\n<div id="chip" class="chip hidden"></div>\n';var T=function(t){c(i,t);var e=u(i);function i(){var t;return r(this,i),(t=e.call(this,P)).setState({id:t.getAttribute("id"),text:t.getAttribute("text")}),t}return l(i,[{key:"onStateChanges",value:function(t){t.text&&(this.shadowRoot.querySelector("#chip").innerHTML=t.text,this.shadowRoot.querySelector("#chip").className="chip")}}]),i}(b);window.customElements.define("ui-chip",T);var R=document.createElement("template");R.innerHTML='\n<style>\n\t@import "style.css";\n</style>\n<div id="pageLoader" class="pageLoader hidden">\n\t<div id="loader" class="loader">Loading...</div>\n</div>\n';var A=function(t){c(i,t);var e=u(i);function i(){var t;return r(this,i),(t=e.call(this,R)).setState({id:t.getAttribute("id"),loading:t.getAttribute("loading")}),t.updateLoadingClass(!!t.getAttribute("loading")),t}return l(i,[{key:"updateLoadingClass",value:function(t){this.shadowRoot.querySelector("#pageLoader").className=t?"pageLoader":"pageLoader hidden"}},{key:"onStateChanges",value:function(t){this.updateLoadingClass(t.loading)}}]),i}(b);window.customElements.define("ui-loader",A);var O=document.createElement("template");O.innerHTML='\n<style>\n\t@import "style.css";\n</style>\n<div id="color-slider" class="color-slider" ontouchstart="return true;">\n\t<div id="handle"></div>\n</div>\n';var I=function(t){c(i,t);var e=u(i);function i(){var t;return r(this,i),(t=e.call(this,O)).handlePos={xLeft:0,xPos:0,xStart:0,xMax:0,posRatio:0},t.shadowRoot.querySelector("#handle").onmousedown=t.onHandleGrab.bind(p(t)),t.shadowRoot.querySelector("#handle").ontouchstart=t.onHandleGrab.bind(p(t)),window.onresize=function(){var e=t.shadowRoot.querySelector("#handle").clientWidth,i=t.handlePos,n=t.shadowRoot.querySelector("#color-slider").getBoundingClientRect(),o=(n.right-n.left)*i.posRatio-e-3;t.handlePos={xLeft:o,xPos:n.left+o-e-3,xStart:n.left,xMax:n.right-e-3,posRatio:i.posRatio},console.log(t.handlePos),t.shadowRoot.querySelector("#handle").style.left=t.handlePos.xLeft+"px"},t.setPosition=t.setPosition.bind(p(t)),t.elementDrag=t.elementDrag.bind(p(t)),t.closeDragElement=t.closeDragElement.bind(p(t)),t}return l(i,[{key:"setPosition",value:function(t){var e=t.clientX;console.log("clientX:",e),e<this.handlePos.xStart?e=this.handlePos.xStart:e>this.handlePos.xMax&&(e=this.handlePos.xMax),console.log("final pos:",e),this.handlePos.xPos=e}},{key:"onHandleGrab",value:function(t){this.handlePos.xStart||(this.handlePos.xStart=t.clientX,this.handlePos.xMax=t.clientX+this.shadowRoot.querySelector("#color-slider").clientWidth-this.shadowRoot.querySelector("#handle").clientWidth-3),t.preventDefault(),this.setPosition(t),document.onmouseup=this.closeDragElement,document.onmousemove=this.elementDrag,document.ontouchend=this.closeDragElement,document.ontouchmove=this.elementDrag}},{key:"elementDrag",value:function(t){t.preventDefault(),this.setPosition(t),this.handlePos.xLeft=this.handlePos.xPos-this.handlePos.xStart,this.shadowRoot.querySelector("#handle").style.left=this.handlePos.xLeft+"px"}},{key:"closeDragElement",value:function(t){var e=this.handlePos;e.posRatio=(e.xPos-e.xStart)/(e.xMax-e.xStart),console.log(e.posRatio),document.onmouseup=null,document.onmousemove=null,document.ontouchend=null,document.ontouchmove=null}}]),i}(b);window.customElements.define("ui-color-slider",I);var L=document.createElement("template");L.innerHTML='\n<style>\n\t@import "style.css";\n</style>\n<div class="toggle-switch on" ontouchstart="return true;">\n\t<div class="circle"></div>\n</div>\n';var q,W,j,B,F=function(t){c(i,t);var e=u(i);function i(){var t;return r(this,i),a(p(t=e.call(this,L)),"onStateChanges",(function(e){t.shadowRoot.querySelector(".toggle-switch").className="toggle-switch ".concat(e.state);var i=new CustomEvent("onToggle",{bubbles:!0,detail:t.state});t.dispatchEvent(i)})),t.setState({state:t.getAttribute("state")||"OFF",id:t.getAttribute("id")}),t.shadowRoot.querySelector(".toggle-switch").className="toggle-switch ".concat(t.state.state),t}return l(i,[{key:"onClick",value:function(){this.setState({state:"ON"===this.state.state?"OFF":"ON"})}},{key:"connectedCallback",value:function(){this.addEventListener("click",this.onClick)}},{key:"disconnectedCallback",value:function(){this.removeEventListener("click",this.onClick)}}]),i}(b);function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
 * @category  html5 widgets
 * @package   Kelly
 * @author    Rubchuk Vladimir <torrenttvi@gmail.com>
 * @copyright 2015-2020 Rubchuk Vladimir
 * @license   GPLv3
 * @version   1.21
 *
 * Usage example :
 *
 *   new KellyColorPicker({place : 'color-picker'});
 *
 * ToDo :
 * 
 * Add switch color in colorsavers button (analog of X button in Photoshop)
 * updateConfig method
 *
 **/function H(t){var e,i=Math.PI,n=!0,o=new Object;o.radius=4;var a=!1,s=!1,r="quad",h=!1,l=!1,c=!0,u=new Array,d=new Array,p=document.createElement("canvas"),v=!1,f=!1,g=null,y=!1,m=!0,b="mixed",w=new Object;w.tag=!1,w.margin=6;var x,S,C,k,D=!1,_=this,z=200,E="#000000",M=1,P=!1,T=!1,R=new Array,A=!1,O=new Array;function I(t,e,i){e=!!e;var n=new Object;n.width,n.widthPercentage=22,n.imageData=null,n.align=t,n.selected=e,n.color="#ffffff",n.position,n.paddingY=-4,n.paddingX=4,n.lineWidth=1,n.selectSize=4,"right"==t&&(n.paddingX=-1*n.paddingX),n.selected&&(n.color=E),i&&(n.color=i),n.updateSize=function(){this.width=parseInt(z-z/100*(100-this.widthPercentage)),"left"==this.align?this.position={x:0,y:z-this.width}:"right"==this.align&&(this.position={x:z-this.width,y:z-this.width})},n.calcS=function(t){return Math.abs((t[1].x-t[0].x)*(t[2].y-t[0].y)-(t[2].x-t[0].x)*(t[1].y-t[0].y))/2},n.isDotIn=function(t){var e=new Array;"left"==this.align?(e[0]={x:this.position.x,y:this.position.y},e[1]={x:this.position.x,y:this.position.y+this.width},e[2]={x:this.position.x+this.width,y:this.position.y+this.width}):(e[0]={x:this.position.x+this.width,y:this.position.y},e[1]={x:e[0].x,y:e[0].y+this.width},e[2]={x:e[0].x-this.width,y:this.position.y+this.width});for(var i=0;i<=e.length-1;++i)e[i].x+=this.paddingX,e[i].y+=this.paddingY;var n=this.calcS(e),o=[{x:e[0].x,y:e[0].y},{x:e[1].x,y:e[1].y},{x:t.x,y:t.y}],a=this.calcS(o);return o[1]={x:e[2].x,y:e[2].y},a+=this.calcS(o),o[0]={x:e[1].x,y:e[1].y},a+=this.calcS(o),Math.ceil(a)==Math.ceil(n)},n.draw=function(){p.width=this.width,p.height=this.width,v.clearRect(0,0,this.width,this.width),v.beginPath(),"left"==this.align&&(v.moveTo(this.lineWidth/2,this.width-this.lineWidth),v.lineTo(this.width,this.width-this.lineWidth),v.lineTo(this.lineWidth,this.lineWidth),v.lineTo(this.lineWidth,this.width-this.lineWidth)),"right"==this.align&&(v.moveTo(this.lineWidth/2,this.width-this.lineWidth),v.lineTo(this.width-this.lineWidth,this.width-this.lineWidth),v.lineTo(this.width-this.lineWidth,this.lineWidth),v.lineTo(this.lineWidth,this.width-this.lineWidth)),this.selected&&(v.fillStyle="rgba(255,255,255, 1)",v.fill(),v.strokeStyle="rgba(0, 0, 0, 1)",v.stroke(),v.closePath(),v.beginPath(),v.lineWidth=this.lineWidth,"left"==this.align&&(v.moveTo(this.selectSize,this.width-this.selectSize),v.lineTo(this.width-2*this.selectSize,this.width-this.selectSize),v.lineTo(this.selectSize,2*this.selectSize),v.lineTo(this.selectSize,this.width-this.selectSize)),"right"==this.align&&(v.moveTo(2*this.selectSize,this.width-this.selectSize),v.lineTo(this.width-this.selectSize,this.width-this.selectSize),v.lineTo(this.width-this.selectSize,2*this.selectSize),v.lineTo(2*this.selectSize,this.width-this.selectSize)));var t=K(this.color);v.fillStyle="rgba("+t.r+","+t.g+","+t.b+", 1)",v.fill(),v.strokeStyle="rgba(0, 0, 0, 1)",v.stroke(),this.imageData=v.getImageData(0,0,this.width,this.width),s.drawImage(p,this.position.x+this.paddingX,this.position.y+this.paddingY)};var o=R.length;R[o]=n}var L=new Object;L.width=18,L.imageData=null,L.innerRadius,L.startAngle=0,L.outerRadius,L.outerStrokeStyle="rgba(0,0,0,0.2)",L.innerStrokeStyle="rgba(0,0,0,0.2)",L.pos,L.draw=function(){if(this.imageData)s.putImageData(this.imageData,0,0);else{for(var t=this.startAngle,e=0;e<=360;e++){var n=Q(e-2),o=Q(e);s.beginPath(),s.moveTo(S,S),s.arc(S,S,this.outerRadius,n,o,!1),s.closePath();var a=V(t/360,1,1);s.fillStyle="rgb("+a.r+", "+a.g+", "+a.b+")",s.fill(),++t>=360&&(t=0)}s.globalCompositeOperation="destination-out",s.beginPath(),s.arc(S,S,this.innerRadius,0,2*i),s.fill(),s.globalCompositeOperation="source-over",s.strokeStyle=this.innerStrokeStyle,s.lineWidth=2,s.stroke(),s.closePath(),s.beginPath(),s.arc(S,S,this.outerRadius,0,2*i),s.strokeStyle=this.outerStrokeStyle,s.lineWidth=2,s.stroke(),s.closePath(),this.imageData=s.getImageData(0,0,z,z)}},L.isDotIn=function(t){return Math.pow(this.pos.x-t.x,2)+Math.pow(this.pos.y-t.y,2)<Math.pow(this.outerRadius,2)&&Math.pow(this.pos.x-t.x,2)+Math.pow(this.pos.y-t.y,2)>Math.pow(this.innerRadius,2)};var q=new Object;q.lineWeight=2,q.height=4,q.paddingX=2,q.path;var W=new Object;W.width=18,W.padding=4,W.outerStrokeStyle="rgba(0,0,0,0.2)",W.innerStrokeStyle="rgba(0,0,0,0.2)",W.height,W.pos,W.updateSize=function(){this.pos={x:z+W.padding,y:W.padding},this.height=z-2*W.padding},W.draw=function(){var t=s.createLinearGradient(0,0,0,this.height),e=V(C.h,1,1);t.addColorStop(0,"rgba("+e.r+","+e.g+","+e.b+",1)"),t.addColorStop(1,"rgba("+e.r+","+e.g+","+e.b+",0)"),s.beginPath(),s.rect(this.pos.x,this.pos.y,this.width,this.height),s.fillStyle="white",s.fill(),s.fillStyle=t,s.fill(),s.strokeStyle="rgba(0,0,0, 0.2)",s.lineWidth=2,s.stroke(),s.closePath()},W.dotToAlpha=function(t){return 1-Math.abs(this.pos.y-t.y)/this.height},W.alphaToDot=function(t){return{x:0,y:this.height-this.height*t}},W.limitDotPosition=function(t){var e=t.y;return e<this.pos.y&&(e=this.pos.y),e>this.pos.y+this.height&&(e=this.pos.y+this.height),{x:this.pos.x,y:e}},W.isDotIn=function(t){return!(t.x<this.pos.x||t.x>this.pos.x+W.width||t.y<this.pos.y||t.y>this.pos.y+this.height)};var j=new Object;function B(t){var e=t.getBoundingClientRect(),i=0,n=0;return h&&(n=W.width+2*W.padding),t===a?e.width<=e.height?i=e.height:e.height<e.width&&(i=e.width):T?"height"==T?i=e.height:"width"==T&&(i=e.width):e.width>e.height?i=e.height:e.height>=e.width&&(i=e.width),i=parseInt(i),h&&(i-=n),!(i<=0)&&i}function F(t,e){var i=1,n=!1;if("string"==typeof t){if(-1==(t=t.trim(t)).indexOf("(")){if("#"==t.charAt(0)&&(t=t.slice(1)),(t=t.substr(0,8)).length>=3){if(t.length>6&&t.length<8&&(t=t.substr(0,6)),t.length>3&&t.length<6&&(t=t.substr(0,3)),n=t,t.length>=3&&t.length<=4){n="";for(var o=0;o<t.length;o++)n+=t[o]+t[o]}8==n.length&&(i=(255&parseInt(n,16))/255)}}else if(vals=t.split(","),vals.length>=3){switch(t.substring(0,3)){case"rgb":vals[0]=vals[0].replace("rgba(",""),vals[0]=vals[0].replace("rgb(","");var a={r:parseInt(vals[0]),g:parseInt(vals[1]),b:parseInt(vals[2])};a.r<=255&&a.g<=255&&a.b<=255&&(n=J(a));break;case"hsl":vals[0]=vals[0].replace("hsl(",""),vals[0]=vals[0].replace("hsla(","");var s=parseFloat(vals[0])/360,r=parseFloat(vals[1])/100,h=parseFloat(vals[2])/100;s>=0&&r<=1&&h<=1&&(n=J(V(s,r,h)))}4==vals.length&&((!(i=parseFloat(vals[3]))||i<0)&&(i=0),i>1&&(i=1))}}else"object"==N(t)&&(void 0!==t.r&&void 0!==t.g&&void 0!==t.b?n=J(t):void 0!==t.h&&void 0!==t.s&&void 0!==t.l&&(t.h=parseFloat(t.h)/360,t.s=parseFloat(t.s)/100,t.l=parseFloat(t.l)/100,t.h>=0&&t.s<=1&&t.l<=1&&(n=J(V(t.h,t.s,t.l)))),void 0!==t.a&&(i=t.a));return(!1!==n||!e)&&(!1===n&&(n="000000"),{h:n="#"!=n.charAt(0)?"#"+(n=n.substr(0,6)):n.substr(0,7),a:i})}function U(){if(O.quad)return O.quad;var t=new Object;return t.size,t.padding=2,t.path,t.imageData=null,t.dotToSv=function(t){return{s:Math.abs(this.path[3].x-t.x)/this.size,v:Math.abs(this.path[3].y-t.y)/this.size}},t.svToDot=function(t){var e=this.path[0].x,i=this.path[0].y,n=.02;z<150?n=.07:z<100&&(n=.16);for(var o=0;o<this.size;o++)for(var a=0;a<this.size;a++){var s={x:a+e,y:o+i},r=this.dotToSv(s),h=Math.abs(r.s-t.s),l=Math.abs(r.v-t.v);if(h<n&&l<n)return s}return{x:0,y:0}},t.limitDotPosition=function(t){var e=t.x,i=t.y;return e<this.path[0].x&&(e=this.path[0].x),e>this.path[0].x+this.size&&(e=this.path[0].x+this.size),i<this.path[0].y&&(i=this.path[0].y),i>this.path[0].y+this.size&&(i=this.path[0].y+this.size),{x:e,y:i}},t.draw=function(){this.imageData||(this.imageData=s.createImageData(this.size,this.size));for(var t=0,e=this.path[0].x,i=this.path[0].y,n=0;n<this.size;n++)for(var o=0;o<this.size;o++){var a={x:o+e,y:n+i},r=this.dotToSv(a),h=V(C.h,r.s,r.v);this.imageData.data[t+0]=h.r,this.imageData.data[t+1]=h.g,this.imageData.data[t+2]=h.b,this.imageData.data[t+3]=255,t+=4}s.putImageData(this.imageData,e,i),s.beginPath(),s.strokeStyle="rgba(0,0,0, 0.2)",s.lineWidth=2;for(t=0;t<=this.path.length-1;++t)0==t?s.moveTo(this.path[t].x,this.path[t].y):s.lineTo(this.path[t].x,this.path[t].y);s.stroke(),s.closePath()},t.updateSize=function(){var t=2*L.innerRadius-2*q.paddingX-2*this.padding;this.size=Math.floor(t/Math.sqrt(2)),this.path=new Array,this.path[0]={x:this.size/2*-1,y:this.size/2*-1},this.path[1]={x:this.path[0].x+this.size,y:this.path[0].y},this.path[2]={x:this.path[1].x,y:this.path[1].y+this.size},this.path[3]={x:this.path[2].x-this.size,y:this.path[2].y},this.path[4]={x:this.path[0].x,y:this.path[0].y};for(var e=0;e<=this.path.length-1;++e)this.path[e].x+=L.pos.x,this.path[e].y+=L.pos.y},t.isDotIn=function(t){return!(t.x<this.path[0].x||t.x>this.path[0].x+this.size||t.y<this.path[0].y||t.y>this.path[0].y+this.size)},O.quad=t,t}function X(){if(O.triangle)return O.triangle;var t=new Object;return t.size,t.padding=2,t.path,t.imageData=null,t.followWheel=!0,t.s,t.sOnTop=!1,t.outerRadius,t.limitDotPosition=function(t){var e=t.x,i=t.y,n=this.path[0].x,o=this.path[2].x,a=e,s=i;a=Math.min(Math.max(o,a),n);var r=(this.path[0].y-this.path[1].y)/(this.path[0].x-this.path[1].x),h=Math.ceil(this.path[1].y+r*(a-this.path[1].x));r=(this.path[0].y-this.path[2].y)/(this.path[0].x-this.path[2].x);var l=Math.floor(this.path[2].y+r*(a-this.path[2].x));return e<o&&((L.pos.y-i)/(L.pos.x-e),s=i),{x:a,y:s=Math.min(Math.max(h,s),l)}},t.svToDot=function(t){var i=.02;z<150?i=.07:z<100&&(i=.16);for(var n=0;n<this.size;n++)for(var o=0;o<this.size;o++){var a={x:this.path[1].x+o,y:this.path[1].y+n};if(e.isDotIn(a)){var s=this.dotToSv(a),r=Math.abs(s.s-t.s),h=Math.abs(s.v-t.v);if(r<i&&h<i)return a}}return{x:0,y:0}},t.draw=function(){this.imageData||(this.imageData=v.createImageData(this.size,this.size)),p.width=this.size,p.height=this.size;for(var t=this.path[1].x,i=this.path[1].y,n=0,o=0;o<this.size;o++)for(var a=0;a<this.size;a++){var r={x:this.path[1].x+a,y:this.path[1].y+o};if(e.isDotIn(r)){var h=this.dotToSv(r),l=V(C.h,h.s,h.v);this.imageData.data[n+0]=l.r,this.imageData.data[n+1]=l.g,this.imageData.data[n+2]=l.b,this.imageData.data[n+3]=255}else this.imageData.data[n+0]=0,this.imageData.data[n+1]=0,this.imageData.data[n+2]=0,this.imageData.data[n+3]=0;n+=4}v.putImageData(this.imageData,0,0),s.drawImage(p,t,i),s.beginPath(),s.strokeStyle="rgba(0, 0, 0, 0.3)",s.lineWidth=2;var c=this.path;for(n=0;n<=c.length-1;++n)0==n?s.moveTo(c[n].x,c[n].y):s.lineTo(c[n].x,c[n].y);s.stroke(),s.closePath()},t.calcS=function(t){return Math.abs((t[1].x-t[0].x)*(t[2].y-t[0].y)-(t[2].x-t[0].x)*(t[1].y-t[0].y))/2},t.dotToSv=function(t){var e,i,n=function(t,e){var i=(e[0].x-e[1].x)*(e[0].x-e[1].x)+(e[0].y-e[1].y)*(e[0].y-e[1].y),n=(t.x-e[0].x)*(e[1].x-e[0].x)+(t.y-e[0].y)*(e[1].y-e[0].y),o=!0,a=n/i;a<0&&(a=0,o=!1);a>1&&(a=1,o=!1);return{x:e[0].x+a*(e[1].x-e[0].x),y:e[0].y+a*(e[1].y-e[0].y),pt:o}}({x:t.x,y:t.y},this.vol),o=(e=n,i=this.vol[0],Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2)));o<1&&(o=Math.floor(o)),o>this.h-1&&(o=this.h);var a=o/this.h,s=Math.abs(tt(t,this.sSide));return s<30&&(s=30),s=60-(s-=30),{s:s/=60,v:a}},t.isDotIn=function(t){var e=[{x:this.path[0].x,y:this.path[0].y},{x:this.path[1].x,y:this.path[1].y},{x:t.x,y:t.y}],i=this.calcS(e);return e[1]={x:this.path[2].x,y:this.path[2].y},i+=this.calcS(e),e[0]={x:this.path[1].x,y:this.path[1].y},i+=this.calcS(e),Math.ceil(i)==Math.ceil(this.s)},t.updateSize=function(){this.outerRadius=L.innerRadius-q.paddingX-this.padding,this.size=Math.floor(2*this.outerRadius*Math.sin(Q(60)));var t=Math.sqrt(3)/2*this.size;this.h=Math.sqrt(3)/2*this.size,this.path=new Array,this.path[0]={x:this.outerRadius,y:0},this.path[1]={x:this.path[0].x-t,y:this.size/2*-1},this.path[2]={x:this.path[1].x,y:this.size/2},this.path[3]={x:this.path[0].x,y:this.path[0].y};for(var e=0;e<=this.path.length-1;++e)this.path[e].x+=L.pos.x,this.path[e].y+=L.pos.y;if(this.vol=new Array,this.s=this.calcS(this.path),this.sOnTop){var i=Z(this.path[0],this.path[2]);this.vol[0]={x:this.path[1].x,y:this.path[1].y},this.vol[1]={x:i.x,y:i.y},this.sSide=this.path[1]}else{i=Z(this.path[0],this.path[1]);this.vol[0]={x:this.path[2].x,y:this.path[2].y},this.vol[1]={x:i.x,y:i.y},this.sSide=this.path[2]}},O.triangle=t,t}function G(t,e,i,n){return"object"!==N(t)&&(t=document.getElementById(t)),!!t&&(n||(n=""),u[n+e]=i,t.addEventListener?t.addEventListener(e,u[n+e]):t.attachEvent("on"+e,u[n+e]),!0)}function Y(t,e,i){return"object"!==N(t)&&(t=document.getElementById(t)),!!t&&(i||(i=""),!!u[i+e]&&(t.removeEventListener?t.removeEventListener(e,u[i+e]):t.detachEvent("on"+e,u[i+e]),u[i+e]=null,!0))}function V(t,e,i){var n,o,a,s,r,h,l,c;switch(t&&void 0===e&&void 0===i&&(e=t.s,i=t.v,t=t.h),h=i*(1-e),l=i*(1-(r=6*t-(s=Math.floor(6*t)))*e),c=i*(1-(1-r)*e),s%6){case 0:n=i,o=c,a=h;break;case 1:n=l,o=i,a=h;break;case 2:n=h,o=i,a=c;break;case 3:n=h,o=l,a=i;break;case 4:n=c,o=h,a=i;break;case 5:n=i,o=h,a=l}return{r:Math.floor(255*n),g:Math.floor(255*o),b:Math.floor(255*a)}}function $(t,e,i){t&&void 0===e&&void 0===i&&(e=t.g,i=t.b,t=t.r),t/=255,e/=255,i/=255;var n,o,a=Math.max(t,e,i),s=Math.min(t,e,i),r=a,h=a-s;if(o=0==a?0:h/a,a==s)n=0;else{switch(a){case t:n=(e-i)/h+(e<i?6:0);break;case e:n=(i-t)/h+2;break;case i:n=(t-e)/h+4}n/=6}return{h:n,s:o,v:r}}function K(t){var e=parseInt("#"==t.charAt(0)?t.slice(1):t,16);return{r:e>>16,g:e>>8&255,b:255&e}}function J(t){var e=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e};return"#"+e(t.r)+e(t.g)+e(t.b)}function Q(t){return t*(i/180)}function Z(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function tt(t,e,n){e||(e={x:0,y:0});var o=t.x-e.x,a=t.y-e.y,s=180*Math.atan2(a,o)/i;return n&&s<0&&(s=360+s),s}function et(){x=2+q.paddingX,f=!1,L.imageData=null,S=z/2,L.pos={x:S,y:S},L.outerRadius=S-x,L.innerRadius=L.outerRadius-L.width,q.path=[{x:L.innerRadius-q.paddingX,y:-1*q.height},{x:L.outerRadius+q.paddingX,y:-1*q.height},{x:L.outerRadius+q.paddingX,y:q.height},{x:L.innerRadius-q.paddingX,y:q.height},{x:L.innerRadius-q.paddingX,y:-1*(q.height+q.lineWeight/2)}];var t=z;h&&(t+=W.width+2*W.padding),"canvas"!=D.tagName.toLowerCase()&&(D.style.width=t+"px",D.style.height=z+"px"),a.width=t,a.height=z,P!=a&&(a.style.width=t+"px",a.style.height=z+"px");for(var i=0;i<=R.length-1;++i)R[i].updateSize();A&&(A.imageData.triangle=null,A.imageData.quad=null,A.updateSize()),e.updateSize(),h&&W.updateSize()}function it(t){if(y){if(d.updateinput)if(!(0,d.updateinput)(_,y,t))return;var e=M.toFixed(2),i="rgba("+k.r+", "+k.g+", "+k.b+", "+e+")";if(!t)switch(b){case"mixed":y.value=M<1?i:E;break;case"hex":y.value=E;break;case"hsla":y.value="hsla("+(360*C.h).toFixed(2)+", "+(100*C.s).toFixed(2)+"%, "+(100*C.v).toFixed(2)+"%, "+e+")";break;default:y.value=i}m&&(C.v<.5?y.style.color="#FFF":y.style.color="#000",y.style.background=i)}}function nt(){G(a,"mousedown",(function(t){_.mouseDownEvent(t)}),"wait_action_"),G(a,"touchstart",(function(t){_.mouseDownEvent(t)}),"wait_action_"),G(a,"mouseout",(function(t){_.mouseOutEvent(t)}),"wait_action_"),G(window,"touchmove",(function(t){_.touchMoveEvent(t)}),"wait_action_"),G(a,"mousemove",(function(t){_.mouseMoveRest(t)}),"wait_action_")}function ot(){Y(a,"mousedown","wait_action_"),Y(a,"touchstart","wait_action_"),Y(a,"mouseout","wait_action_"),Y(window,"touchmove","wait_action_"),Y(a,"mousemove","wait_action_")}function at(t){var e,i;t=t||window.event;var n=document.body.scrollLeft+document.documentElement.scrollLeft,o=document.body.scrollTop+document.documentElement.scrollTop;"touchend"==t.type?(e=t.changedTouches[0].clientX+n,i=t.changedTouches[0].clientY+o):"touchmove"==t.type||t.touches?(e=t.touches[0].clientX+n,i=t.touches[0].clientY+o):(e=t.clientX+n,i=t.clientY+o);var s=a.getBoundingClientRect();return{x:e-=s.left+n,y:i-=s.top+o}}function st(t){for(var e=!1,i=0;i<=R.length-1;++i)R[i].selected&&(e=i),R[i].selected=!1;var n=!1;for(i=0;i<=R.length-1;++i)if(i==t){R[i].selected=!0,_.setColorByHex(R[i].color),n=!0;break}n&&d.selectcolorsaver&&(0,d.selectcolorsaver)(_,R[t]);return n||!1===e||(R[e].selected=!0),n}function rt(){for(var t=0;t<=R.length-1;++t)R[t].selected&&(R[t].color=E)}function ht(){if(R.length)for(var t=0;t<=R.length-1;++t)R[t].draw()}function lt(){if(!s||(s.clearRect(0,0,a.width,a.height),!(f?(s.putImageData(g,0,0),ht(),1):(L.draw(),e.draw(),h&&W.draw(),ht(),A&&A.draw(),l||(g=s.getImageData(0,0,a.width,a.height),f=!0),1))))return!1;var t=360*C.h-L.startAngle;if(h){s.beginPath();var n=W.height*(1-M);s.rect(W.pos.x-2,W.padding+n-1,W.width+4,2),s.strokeStyle="rgba(0,0,0, 0.8)",s.lineWidth=2,s.stroke(),s.closePath()}s.beginPath();for(var r=function(t,e){e=Q(e);for(var i=new Array,n=0;n<=t.length-1;++n)i[n]={x:t[n].x*Math.cos(e)-t[n].y*Math.sin(e),y:t[n].x*Math.sin(e)+t[n].y*Math.cos(e)};return i}(q.path,t,(L.pos.x,L.pos.y)),c=0;c<=r.length-1;++c)r[c].x+=L.pos.x,r[c].y+=L.pos.y,0==c?s.moveTo(r[c].x,r[c].y):s.lineTo(r[c].x,r[c].y);return s.strokeStyle="rgba(0,0,0,0.8)",s.lineWidth=q.lineWeight,s.stroke(),s.closePath(),C.v>.5&&C.s<.5?s.strokeStyle="rgba(0, 0, 0, 1)":s.strokeStyle="rgba(255, 255, 255, 1)",s.beginPath(),s.lineWidth=2,s.arc(C.x,C.y,o.radius,0,2*i),s.stroke(),s.closePath(),!1}j.svCursorData=null,j.stCursor=null,j.curType=0,j.size=16,j.cEl=document.body,j.initSvCursor=function(){if(!a)return!1;if(this.curType=1,this.stCursor||(this.stCursor=window.getComputedStyle(this.cEl).cursor,this.stCursor||(this.stCursor="auto")),this.svCursorData)return this.cEl.style.cursor=this.svCursorData,!0;if(!p)return!1;var t=this.size+2;p.width=t,p.height=t,v.clearRect(0,0,this.size,this.size),v.strokeStyle="rgba(255, 255, 255, 1)",v.beginPath(),v.lineWidth=2,v.arc(t/2,t/2,this.size/2,0,2*i),v.stroke(),v.closePath();var e=t,n=p.toDataURL();return this.svCursorData="url("+n+") "+e/2+" "+e/2+", auto",!!this.svCursorData&&(this.cEl.style.cursor=this.svCursorData,-1===this.cEl.style.cursor.indexOf(n)&&(this.svCursorData="crosshair",this.cEl.style.cursor="crosshair"),!0)},j.initStandartCursor=function(){this.stCursor&&(j.curType=0,this.cEl.style.cursor=this.stCursor)},j.updateCursor=function(t){n&&(H.cursorLock||(e.isDotIn(t)?j.initSvCursor():j.initStandartCursor()))},this.popUpClose=function(t){if(!1!==w.tag){if(t){if(t.target==y||t.target==a)return!1;if(t.target==w.tag)return!1}d.popupclose&&!d.popupclose(_,t)||(w.tag.style.display="none",H.activePopUp==_&&(H.activePopUp=!1))}},this.popUpShow=function(t){if(!1!==w.tag&&(!d.popupshow||d.popupshow(_,t))){H.popupEventsInclude||(G(document,"click",(function(t){return!!H.activePopUp&&H.activePopUp.popUpClose(t)}),"popup_close_"),G(window,"resize",(function(t){if(H.activePopUp)return H.activePopUp.popUpShow(t)}),"popup_resize_"),H.popupEventsInclude=!0),H.activePopUp&&H.activePopUp.popUpClose(!1);var e=_.getCanvas().width,i=_.getAlphaFig();i&&(e-=i.width+i.padding);var n=window.getComputedStyle(w.tag),o=parseInt(n.paddingBottom)+parseInt(n.paddingTop);o<=0&&(o=0);var a=y.getBoundingClientRect(),s=a.top+(window.scrollY||window.pageYOffset||document.body.scrollTop)-o,r=a.left+(window.scrollX||window.pageXOffset||document.body.scrollLeft);return w.tag.style.top=s-e-w.margin+"px",w.tag.style.left=r+"px",w.tag.style.display="block",H.activePopUp=_,!1}},this.setHueByDot=function(t){var e=tt(t,L.pos)+L.startAngle;(e<0&&(e=360+e),C.h=e/360,k=V(C.h,C.s,C.v),E=J(k),rt(),d.change)&&(0,d.change)(_);it(),f=!1,lt()},this.setColorForColorSaver=function(t,e){var i=F(t,!0);if(i){var n=_.getColorSaver(e);return n.selected?this.setColorByHex(t,!1):(n.color=i.h,lt()),!0}},this.setColor=function(t,e){_.setColorByHex(t,e)},this.setColorByHex=function(t,i){i||(i=!1);var n=M;if(!1!==t){if(!t||!t.length)return;var o=F(t,!0);if(!o)return;t=o.h,h&&(n=o.a)}else t=E;if(h&&t==E&&f&&n!=M)return M=n,void lt();if(!E||t!=E||!f){M=n,k=K(t),E=t,C=$(k);var a=e.svToDot(C);if(C.x=a.x,C.y=a.y,f=!1,rt(),lt(),d.change)(0,d.change)(_);it(i)}},this.setAlphaByDot=function(t){(M=W.dotToAlpha(t),d.change)&&(0,d.change)(_);it(),lt()},this.setAlpha=function(t){M=t,it(),lt()},this.setColorByDot=function(t){var i=e.dotToSv(t);(C.s=i.s,C.v=i.v,C.x=t.x,C.y=t.y,C.s>1&&(C.s=1),C.s<0&&(C.s=0),C.v>1&&(C.v=1),C.v<0&&(C.v=0),k=V(C.h,C.s,C.v),E=J(k),rt(),d.change)&&(0,d.change)(_);it(),lt()},this.mouseOutEvent=function(t){j.curType>0&&!H.cursorLock&&j.initStandartCursor()},this.mouseMoveRest=function(t){if(!l&&c){c=!1;var e=at(t);if(j.updateCursor(e),requestAnimationFrame((function(){c=!0})),d.mousemoverest)(0,d.mousemoverest)(t,_,e)}},this.touchMoveEvent=function(t){l&&event.preventDefault()},this.mouseDownEvent=function(t){t.preventDefault();var i,n=!1,o=at(t);if(L.isDotIn(o))l="wheel",_.setHueByDot(o),i=function(t){_.wheelMouseMove(t,o)},n=function(t){H.cursorLock=!1,_.wheelMouseUp(t,o)};else if(e.isDotIn(o))l="sv",_.setColorByDot(o),i=function(t){_.svMouseMove(t,o)},n=function(t){H.cursorLock=!1,_.svMouseUp(t,o)};else if(h&&W.isDotIn(o))l="alpha",_.setAlphaByDot(o),i=function(t){_.alphaMouseMove(t,o)},n=function(t){H.cursorLock=!1,_.alphaMouseUp(t,o)};else if(A&&A.isDotIn(o))_.setMethod();else if(R.length)for(var a=0;a<=R.length-1;++a)if(R[a].isDotIn(o)){st(a);break}i&&n&&(ot(),H.cursorLock=_,G(document,"mouseup",n,"action_process_"),G(document,"mousemove",i,"action_process_"),G(document,"touchend",n,"action_process_"),G(document,"touchmove",i,"action_process_"))},this.wheelMouseMove=function(t,e){if(t.preventDefault(),l&&c){c=!1;var i=at(t);if(requestAnimationFrame((function(){c=!0})),_.setHueByDot(i),d.mousemoveh)(0,d.mousemoveh)(t,_,i)}},this.wheelMouseUp=function(t,e){if(t.preventDefault(),l){Y(document,"mouseup","action_process_"),Y(document,"mousemove","action_process_"),Y(document,"touchend","action_process_"),Y(document,"touchmove","action_process_"),nt(),l=!1,f=!1,lt();var i=at(t);if(j.updateCursor(i),d.mouseuph)(0,d.mouseuph)(t,_,i)}},this.alphaMouseMove=function(t,e){if(t.preventDefault(),l&&c){c=!1;var i=at(t);if(i=W.limitDotPosition(i),requestAnimationFrame((function(){c=!0})),_.setAlphaByDot(i),d.mousemovealpha)(0,d.mousemovealpha)(t,_,i)}},this.alphaMouseUp=function(t,e){if(t.preventDefault(),l){Y(document,"mouseup","action_process_"),Y(document,"mousemove","action_process_"),Y(document,"touchend","action_process_"),Y(document,"touchmove","action_process_"),nt(),l=!1;var i=at(t);if(j.updateCursor(i),d.mouseupalpha)(0,d.mouseupalpha)(t,_,i)}},this.svMouseMove=function(t,i){if(t.preventDefault(),l&&c){c=!1;var n=at(t);if(n=e.limitDotPosition(n),requestAnimationFrame((function(){c=!0})),_.setColorByDot(n),d.mousemovesv)(0,d.mousemovesv)(t,_,n)}},this.svMouseUp=function(t,e){if(t.preventDefault(),l){Y(document,"mouseup","action_process_"),Y(document,"mousemove","action_process_"),Y(document,"touchend","action_process_"),Y(document,"touchmove","action_process_"),nt(),l=!1;var i=at(t);if(j.updateCursor(i),h&&(f=!1,lt()),d.mouseupsv)(0,d.mouseupsv)(t,_,i)}},this.addUserEvent=function(t,e){return d[t]=e,!0},this.removeUserEvent=function(t){return!!d[t]&&(d[t]=null,!0)},this.getCanvas=function(){return!!s&&a},this.getCtx=function(){return s||!1},this.getInput=function(){return y},this.getSvFig=function(){return e},this.getSvFigCursor=function(){return o},this.getWheel=function(){return L},this.getWheelCursor=function(){return q},this.getCurColorHsv=function(){return C},this.getCurColorRgb=function(){return k},this.getCurColorHex=function(){return E},this.getCurColorRgba=function(){return{r:k.r,g:k.g,b:k.b,a:M}},this.getCurAlpha=function(){return M},this.getAlphaFig=function(){return!!h&&W},this.getPopup=function(){return w},this.getSize=function(){return z},this.getColorSaver=function(t){for(var e=0;e<=R.length-1;++e)if(!t&&R[e].selected||R[e].align==t)return R[e].rgb=K(R[e].color),R[e].hsv=$(R[e].rgb.r,R[e].rgb.g,R[e].rgb.b),R[e]},this.setColorSaver=function(t){if(!t)return!1;for(var e=0;e<=R.length-1;++e)if(R[e].align==t)return st(e),R[e]},this.updateView=function(t){return!!s&&(t&&(L.imageData=null,e.imageData=null,g=null),f=!1,et(),lt(),!0)},this.resize=function(t,i){return!!s&&(t==z&&!i||(f=!1,L.imageData=null,e.imageData=null,g=null,z=t,et(),_.setColorByHex(!1),!1))},this.syncSize=function(t){if(!P)return!1;var e=B(P);return e&&_.resize(e),!1},this.setMethod=function(t){if(t||(t="triangle","triangle"==r&&(t="quad")),t==r)return!1;if("quad"!=r&&"triangle"!=r)return!1;("quad"==(r=t)&&(e=U()),"triangle"==r&&(e=X()),_.resize(z,!0),d.setmethod)&&(0,d.setmethod)(_,r);return!0},this.destroy=function(){if(!_)return!1;j.curType>0&&(H.cursorLock=!1,j.initStandartCursor()),l&&(Y(document,"mouseup","action_process_"),Y(document,"mousemove","action_process_"),Y(document,"touchend","action_process_"),Y(document,"touchmove","action_process_"),l=!1),w.tag&&Y(y,"click","popup_"),y&&(Y(y,"click","input_edit_"),Y(y,"change","input_edit_"),Y(y,"keyup","input_edit_"),Y(y,"keypress","input_edit_")),H.popupEventsInclude&&u.popup_close_click&&(H.activePopUp&&H.activePopUp.popUpClose(!1),Y(document,"click","popup_close_"),Y(window,"resize","popup_resize_"),H.popupEventsInclude=!1),L.imageData=null,e.imageData=null,g=null,p=null,D&&D.parentNode&&D.parentNode.removeChild(D),P&&Y(window,"resize","canvas_"),ot(),_=null},function(t){var o="",l="";if(void 0!==t.alpha_slider&&(t.alphaSlider=t.alpha_slider),void 0!==t.input_color&&(t.inputColor=t.input_color),void 0!==t.input_format&&(t.inputFormat=t.input_format),t.input&&"object"!==N(t.input)?(t.input=document.getElementById(t.input),y=t.input):"object"===N(t.input)&&(y=t.input),void 0!==t.changeCursor&&(n=t.changeCursor),void 0!==t.alpha&&(M=t.alpha),void 0!==t.alphaSlider&&(h=t.alphaSlider),void 0!==t.inputColor&&(m=t.inputColor),void 0!==t.inputFormat&&(b=t.inputFormat),t.userEvents&&(d=t.userEvents),t.place&&"object"!==N(t.place)&&(l=t.place,t.place=document.getElementById(t.place)),t.place)D=t.place;else if(y){w.tag=document.createElement("div"),w.tag.className="popup-kelly-color",t.popupClass?w.tag.className=t.popupClass:(w.tag.className="popup-kelly-color",w.tag.style.position="absolute",w.tag.style.bottom="0px",w.tag.style.left="0px",w.tag.style.display="none",w.tag.style.backgroundColor="#e1e1e1",w.tag.style.border="1px solid #bfbfbf",w.tag.style.boxShadow="7px 7px 14px -3px rgba(0,0,0,0.24)",w.tag.style.borderTopLeftRadius="4px",w.tag.style.borderTopRightRadius="4px",w.tag.style.borderBottomLeftRadius="4px",w.tag.style.borderBottomRightRadius="4px",w.tag.style.padding="12px",w.tag.style.boxSizing="content-box"),D=w.tag,document.getElementsByTagName("body")[0].appendChild(w.tag),G(y,"click",(function(t){return _.popUpShow(t)}),"popup_")}else o+='| "place" ('+l+") not not found";var c=!1;if(t.color?c=F(t.color):y&&y.value&&(c=F(y.value)),c&&(E=c.h,h&&(M=c.a)),!t.method||"triangle"!=t.method&&"quad"!=t.method||(r=t.method),function(){if(!D)return!1;"CANVAS"!=D.tagName?(a=document.createElement("CANVAS"),D.appendChild(a)):a=D;void 0!==window.G_vmlCanvasManager&&(a=window.G_vmlCanvasManager.initElement(a),p=window.G_vmlCanvasManager.initElement(p));return!(!a.getContext||!a.getContext("2d"))&&(s=a.getContext("2d"),v=p.getContext("2d"),!0)}()||(o+=" | cant init canvas context"),t.resizeWith&&("object"!==N(t.resizeWith)&&"boolean"!=typeof t.resizeWith&&(t.resizeWith=document.getElementById(t.resizeWith)),P=!0===t.resizeWith?a:t.resizeWith,t.resizeSide&&(T=t.resizeSide),P&&(B(P)&&(t.size=B(P)),G(window,"resize",(function(t){return _.syncSize(t)}),"canvas_"))),t.size&&t.size>0&&(z=t.size),o)"undefined"!=typeof console&&console.log("KellyColorPicker : "+o);else{if("quad"==r&&(e=U()),"triangle"==r&&(e=X()),y){var u=function(t){(t=t||window.event).target||(t.target=t.srcElement),_.setColorByHex(t.target.value,!0)};G(y,"click",u,"input_edit_"),G(y,"change",u,"input_edit_"),G(y,"keyup",u,"input_edit_"),G(y,"keypress",u,"input_edit_")}t.colorSaver&&(I("left",!0),I("right")),t.methodSwitch&&((A=new Object).size,A.sizePercentage=10,A.position,A.paddingY=4,A.paddingX=4,A.imageData=new Array,A.lineWidth=2,A.color="#c1ebf5",A.updateSize=function(){this.size=parseInt(z-z/100*(100-this.sizePercentage)),this.size<16&&(this.size=16),this.position={x:this.paddingX,y:this.paddingY}},A.draw=function(){if(this.imageData[r])s.putImageData(this.imageData[r],this.position.x,this.position.y);else{var t=K(this.color);p.width=this.size,p.height=this.size,v.clearRect(0,0,this.size,this.size),v.beginPath();var e,n="triangle";if("triangle"==r&&(n="quad"),v.beginPath(),this.size<35)var o=a=p.width/2;else{var a=p.width/2-this.lineWidth;v.arc(this.size/2,this.size/2,a,0,2*i),v.strokeStyle="rgba(0, 0, 0, 0.4)",v.lineWidth=this.lineWidth,v.stroke(),o=a-6,v.closePath(),v.beginPath(),v.arc(this.size/2,this.size/2,o,0,2*i),v.strokeStyle="rgba(0, 0, 0, 0.4)",v.lineWidth=this.lineWidth,v.stroke(),v.closePath()}if(v.beginPath(),"quad"==n){var h=2*o-4;e=Math.floor(h/Math.sqrt(2));var l=(this.size-e)/2;(c={x:l+e,y:l+e/2}).y=c.y-e/2,v.moveTo(c.x,c.y),v.lineTo(c.x-e,c.y),v.lineTo(c.x-e,c.y+e),v.lineTo(c.x,c.y+e)}else{e=Math.floor((2*o-4)*Math.sin(Q(60)));var c={x:2*o+(a-o),y:this.size/2},u=Math.sqrt(3)/2*e;v.moveTo(c.x,c.y),v.lineTo(c.x-u,c.y-e/2),v.lineTo(c.x-u,c.y+e/2),v.lineTo(c.x,c.y)}v.lineTo(c.x,c.y),v.fillStyle="rgba("+t.r+","+t.g+","+t.b+", 1)",v.fill(),v.lineWidth=this.lineWidth,v.strokeStyle="rgba(0, 0, 0, 0.6)",v.stroke(),v.closePath(),this.imageData[r]=v.getImageData(0,0,p.width,p.width),s.drawImage(p,this.position.x,this.position.y)}},A.isDotIn=function(t){return t.x>=this.position.x&&t.x<=this.position.x+this.size&&t.y>=this.position.y&&t.y<=this.position.y+this.size}),nt(),et(),_.setColorByHex(!1)}}(t)}function U(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return X(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return X(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,r=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return s=t.done,t},e:function(t){r=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(r)throw a}}}}function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}window.customElements.define("toggle-switch",F),H.cursorLock=!1,H.activePopUp=!1,H.popupEventsInclude=!1,H.attachToInputByClass=function(t,e){for(var i=new Array,n=document.getElementsByClassName(t),o=0;o<n.length;o++)e?e.input=n[o]:e={input:n[o],size:150},i.push(new H(e));return i},(W=q||(q={}))[W.STANDBY=0]="STANDBY",W[W.RGB=1]="RGB",W[W.WHITE=2]="WHITE",W[W.GPIO_TESTING=3]="GPIO_TESTING",(B=j||(j={}))[B.OFF=0]="OFF",B[B.ON=1]="ON";var G,Y,V,$=q.STANDBY,K=function(t,e){var i=document.getElementById(t);i&&i.setState(e)},J=function(){var t=function(t){Y=t,console.log(Y),Y.device&&(Object.keys(Y.device).forEach((function(t){K(t,{value:Y.device[t]})})),Y.device.name&&K("title-chip",{text:Y.device.name})),Y.network&&Object.keys(Y.network).forEach((function(t){K(t,{value:Y.network[t]})}))};t({device:{name:"Bulb Test 1",map_preset:"wemos",device_type:0,gpio_w:15,gpio_ww:13,gpio_r:12,gpio_g:14,gpio_b:16},network:{ssid:"Fake SSID",password:"password"}})},Q=function(){$!==q.RGB&&($=q.RGB,document.querySelector("#modeRgb").setState({state:"ON"}));var t=V.getCurColorRgb(),e="00".concat(t.r).slice("00".concat(t.r).length-3),i="00".concat(t.g).slice("00".concat(t.g).length-3),n="00".concat(t.b).slice("00".concat(t.b).length-3);G&&G.send("rgbctrl:r:".concat(e,":g:").concat(i,":b:").concat(n))};(function(){document.addEventListener("touchstart",(function(){}),!0);for(var t=Array.from(document.querySelectorAll(".mode-toggle")),e=0,i=t;e<i.length;e++)i[e].addEventListener("onToggle",(function(e){var i=e.target.state;if("ON"===i.state){var n,o=U(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;a.state.id!==i.id&&"ON"===a.state.state&&a.setState({state:"OFF"})}}catch(t){o.e(t)}finally{o.f()}switch(i.id){case"modeRgb":$=q.RGB,document.querySelector("#rgb-warning").setState({text:"While manual RGB mode is enabled, Lumenator will not respond to external control commands."}),Q();break;case"modeWhite":$=q.WHITE;break;default:$=q.GPIO_TESTING,document.querySelector("#gpio-test-warning").setState({text:"While GPIO testing is enabled, Lumenator will not respond to external control commands."})}}else"OFF"===i.state&&($=q.STANDBY,document.querySelector("#gpio-test-warning").setState({visible:!1,text:null}),document.querySelector("#rgb-warning").setState({visible:!1,text:null}),G&&G.send("standby"));G&&"modeRgb"!==i.id&&"modeWhite"!==i.id&&G.send("".concat(e.detail.id,":").concat(j[e.detail.state]))}))})(),J(),V=new{}({place:"control-color-picker",size:225,color:"rgb(0, 0, 255)",userEvents:{mousemoveh:function(){Q()},mousemovesv:function(){Q()},mouseuph:function(){Q()},mouseupsv:function(){Q()}}})}();